/*!
 * 
 * SpreadJS Library 13.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Comments=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/comment/comment.entry.js")}({"./dist/plugins/comment/comment-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("Core"),g=e.GC$,h=e.Events,i=d.Common.j.Fa,j=f.Commands.ActionBase,k="deleteComment",l="deleteCommentByKey",m="deactivateComment",n="moveCommentUp",o="moveCommentDown",p="moveCommentLeft",q="moveCommentRight",r="changeComment",s="changeCommentTransaction",t=null,u=f.Commands.h4;function A(a,b,c){var d,f=!1,g=a.ITa.Ky.JU();return g?(d=g.location(),a.wu().execute({cmd:r,sheetName:a.name(),row:g.nT,col:g.oT,oldValue:d.clone(),newValue:new e.Point(d.x+b,d.y+c),propertyName:"location"})):f}function B(a){var b=a.comment;b&&(i(a.row)||i(a.col))&&(a.row=b.nT,a.col=b.oT)}v=function(a){z(b,a);function b(b,c){var d=a.call(this)||this;return B(c),d.kj=b,d.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,g,i=this;return!!i.canExecute()&&(a=i.kj,i.Lz(a,!0),b=a.comments.get(i.VQ.row,i.VQ.col),c=a.ITa,d=c.Ky,e={sheet:a,sheetName:a.name(),comment:b,cancel:!1},a.Wq(h.CommentRemoving,e),e.cancel||(c.startTransaction(),d.remove(b.nT,b.oT),d.rV=t,a.GJ(),a.Wq(h.CommentRemoved,{sheet:a,sheetName:a.name(),comment:b}),g=f.Commands.bWa(a.name()),i.VQ[g]=c.endTransaction()),i.Mz(a,!0),!0)},b.prototype.undo=function(){var a,b=this,c=b.kj;return b.Lz(c,!0),a=f.Commands.bWa(c.name()),c.ITa.undo(b.VQ[a]),c.EJ(),b.Mz(c,!0),!0},b}(j),b.CommentDeleteUndoAction=v,w=function(a){z(b,a);function b(b,c){var d=a.call(this)||this;return B(c),d.kj=b,d.VQ=c,d}return b.prototype.execute=function(){var a,b=this,c=b.VQ,d=b.kj,e=d.comments.get(c.row,c.col);return!(!b.canExecute()||!e)&&(b.Lz(d,!0),a=c.propertyName,e[a](c.newValue),"location"===a&&(c.displayMode?e.displayMode(c.displayMode):c.displayMode=e.displayMode()),b.Mz(d,!0),!0)},b.prototype.undo=function(){var a,b=this,c=b.VQ,d=b.kj;return b.Lz(d,!0),a=d.comments.get(c.row,c.col),!!a&&(a[c.propertyName](c.oldValue),b.Mz(d,!0),!0)},b}(j),b.CommentPropertyUndoAction=w,f.Commands.ChangeComment=w;function C(a,b){var c,d,e;if((b?a.canUndo():a.canExecute())&&(c=a.KV)){for(d=0;d<c.length;d++)e=c[d],e&&(b?e.undo():e.execute());return!0}return!1}x=function(a){z(b,a);function b(b,c){var d,e,f=a.call(this)||this,g=f;if(g.KV=[],g.kj=b,g.VQ=c,d=c.commands)for(e=0;e<d.length;e++)g.add(d[e]);return f}return b.prototype.execute=function(){return C(this,!1)},b.prototype.undo=function(){return C(this,!0)},b.prototype.add=function(a){this.KV.push(a)},b}(j),f.Commands[l]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b),d=c.ITa.Ky.JU();return!!d&&c.wu().execute({cmd:k,sheetName:c.name(),row:d.nT,col:d.oT})}},f.Commands[m]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b),d=c.ITa.Ky;return!!d.JU()&&(d.vQ(),c.GJ(),c.repaint(),!0)}},f.Commands[n]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return A(c,0,-1)}},f.Commands[o]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return A(c,0,1)}},f.Commands[p]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return A(c,-1,0)}},f.Commands[q]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return A(c,1,0)}},f.Commands[k]={canUndo:!0,execute:function(a,b,c){return u(a,v,b,c)}},f.Commands[r]={canUndo:!0,execute:function(a,b,c){return u(a,w,b,c)}},f.Commands[s]={canUndo:!0,execute:function(a,b,c){return u(a,x,b,c)}},y=function(a){var b=e.Ul.sl();a.register(l,f.Commands[l],b?8:46,!1,!1,!1,!1),a.register(m,f.Commands[m],27,!1,!1,!1,!1),a.register(n,f.Commands[n],38,!1,!1,!1,!1),a.register(o,f.Commands[o],40,!1,!1,!1,!1),a.register(p,f.Commands[p],37,!1,!1,!1,!1),a.register(q,f.Commands[q],39,!1,!1,!1,!1),a.register(k,f.Commands[k]),a.register(r,f.Commands[r]),a.register(s,f.Commands[s])},f.Commands.uT=y},"./dist/plugins/comment/comment-touch.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/comment/comment.js"),f=c("Touch"),d.Rxb.touch&&(g=d.GC$,h=d.Ul.nl,i=function(){function a(a,b){var c=this;c.NS=a,c.LV=b,c.kT=b.kT,c.kj=c.kT.kj,c.hQ=new f.TP(c.kj)}return a.prototype.OS=function(a){var b,c=new f.oP(a.X,a.Y),d=g(this.NS).offset();return d&&(b=document.body,c.X+=d.left+b.clientLeft||0,c.Y+=d.top+b.clientTop||0),c},a.prototype.jQ=function(a){a.DO=35},a.prototype.lQ=function(a){var b=this,c=b.OS(a.rN);b.LV.iV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},a.prototype.pQ=function(a){var b,c,d=this,e=a.dP.rO,f=d.kj,h=f.parent;1!==e&&h&&h.options.allowUserZoom?(f.mm.lV=!1,b=d.LV,g(b.TU).remove(),d.hQ.PP(e)):(c=d.OS(a.rN),d.LV.BD({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}))},a.prototype.qQ=function(a){var b,c=this,d=a.dP.rO,e=c.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?c.hQ.SP(d):(b=c.OS(a.rN),c.LV.CD({target:a.GP,isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},a.prototype.sQ=function(a){var b=this,c=b.kT,d=b.kj;try{d.suspendPaint(),3===c.commentState()?c.commentState(1):1===c.commentState()&&c.commentState(2)}finally{d.resumePaint()}},a}(),j=function(){function a(a,b,c,d){var e,g=this,h=g.kT=b.kT;g.yM=new f.jR(g),g.DQ=new f.kR(a,"Comment"+h.nT+h.oT,g.yM,2,200),g.BQ=c,g.CQ=d,e=g.DQ,e._M=function(){return 3!==h.commentState()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}return a.prototype.EQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},a.prototype.FQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},a.prototype.GQ=function(a){return this.yM.GQ()},a.prototype.HQ=function(a){return this.yM.HQ()},a.prototype.IQ=function(a){return this.yM.IQ()},a}(),k=function(a){n(b,a);function b(b,c,d){return a.call(this,b,c,d,new i(b,c))||this}return b}(j),l=function(a){n(b,a);function b(b,c,d){return a.call(this,b,c,d,new m(b,c))||this}return b}(j),m=function(a){n(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.lQ=function(a){var b=this,c=b.OS(a.rN);b.LV.hV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},b}(i),e.GV.$n("touch",{init:function(a){var b=this,c=b.kT.kj,d=c.parent.BQ;b.wR=new k(a[0],b,d),b.wR.EQ(),b.MV=new l(a[1],b,d),b.MV.EQ()},detachEditor:function(a){var b=this,c=b.kT.kj;b.MV=new l(a,b,c.parent.BQ),b.MV.EQ()},preProcessMouseDownEdit:function(a){var b=a.e,c=this.MV;c&&!b.isTouch&&c.GQ(b)&&(h(b),a.r=!0)},preProcessMouseDownDragResize:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(h(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.IQ(b)&&(h(b),a.r=!0),e&&!c&&e.IQ(b)&&(h(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.HQ(b)&&(h(b),a.r=!0),e&&!c&&e.HQ(b)&&(h(b),a.r=!0)}}))},"./dist/plugins/comment/comment.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/comment/comment.js")),d(c("./dist/plugins/comment/comment-actions.js")),c("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("Core"),g=e.Commands,h=e.Worksheet,i=null,j=void 0,k=Math.max,l=Math.min,m=Math.floor,n=Math.atan2,o=Math.abs,p="default",q=e.GC$.extend,r=e.Ul.Nl,s=d.Common.k,t="comment",u=e.Vl,v=e.En,w=e.Ul,x=e.Events,y=w.nl,z=w.Rl,A=w.Voa,B=parseFloat,C=d.Common.u,D=e.Bn,E=document,F=window,G="mouse",H="move",I=G+"down",J=G+H,K=G+"up",L=G+"wheel",M="DOMMouseScroll",N="left",O="top",P="right",Q="bottom",R="width",S="height",T="position",U="absolute",V="overflow",W="visible",X="z-index",Y="hidden",Z="box-sizing",$="content-box",_="padding",aa="px",ba="div",ca=".comment",da=".floatBlockCanvas",ea=".hostContainer",fa=".lineCanvasContainer",ga=".host",ha=".editor",ia="gc-spread-",ja="className",ka="cursor",la="text",ma=701,na=898,oa="gc-no-user-select",pa=" ",qa="unselectable",ra="on",sa="comment_editor",ta="comment_indicator",ua="font-family",va="font-style",wa="font-size",xa="font-weight",ya="color",za="background-"+ya,Aa=la+"-align",Ba=la+"-decoration",Ca="textArea",Da=".lineCanvas",Ea=".commentDocument",Fa="-resize",Ga="line-height";function Za(a,b){return new f.Point(a,b)}function $a(a,b,c,d){return new f.Rect(a,b,c,d)}function _a(a){return a.height}function ab(a){return a.width}function bb(a,b){var c=a.options;return!c.isProtected||c.protectionOptions.allowEditObjects||b&&!b.locked()}e.GC$.extend(h.prototype,{RP:function(a){var b,c,d,e,f,g=this,h=g.nQ();if(!g.fI)for(b=g.am(),c=void 0,d=0;d<=2;d++)for(e=0;e<=2;e++)c=b.Ft(d,e),c&&0!==ab(c)&&0!==_a(c)&&(a&&!c.intersectRect(a)||(f=g.ITa.Ky,h&&f&&h.fT(f)))}}),Ha=e.CellRange,Ha.prototype.comment=function(a){var b=this,c=b.sheet,d=b.row,e=b.col;return 0===arguments.length?c.ITa.Ky.get(d,e):(a instanceof Oa&&c.ITa.Ky.Cz(d,e,a),b)},Ia=function(a,b){var c=a.Vs(),d=a.hitTest(b.pageX-c.left,b.pageY-c.top);d&&fb(a,d)},Ja=function(a,b){var c=b.ITa.Ky;b.bind(x.TopRowChanged+ca,function(){c.cQ()}),b.bind(x.LeftColumnChanged+ca,function(){c.cQ()}),b.bind(x.FloatingElementSelected+ca,function(a,b){"comments"!==b.type&&(c.vQ(),c.tT(i))}),a.bind(I+ca,function(a){c.vQ(),Ia(b,a)}).bind(L+ca,function(a){Ia(b,a)}).bind(J+ca,function(a){Ia(b,a)})},Ka=function(a,b){b.unbind(ca),a.unbind(ca)};function cb(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=l.ITa.Ky;if(a&&m)for(g=m.all(),h=0;h<g.length;h++)f=g[h],i=f.nT,j=f.oT,i===b&&j===c||i>=b&&i<b+d&&j>=c&&j<c+e&&m.remove(i,j);f=m.get(b,c),f&&(k=m.pT(f),k&&k.qT())}function db(){var a=this,b=a.nQ();b&&b.rT(a)}function eb(a,b,c){var d=this,e=d.nQ();e&&e.sT(a,b,c)}function fb(a,b){var c,d=-1,e=-1;if(b&&b.rowViewportIndex>=0&&b.colViewportIndex>=0&&(d=b.row,e=b.col),a.parent){if(d<0||e<0)return;c=a.ITa.Ky.get(d,e),a.ITa.Ky.tT(c)}}function gb(a,b){return a&&a.getRowHeight(b)}function hb(a,b){return a&&a.getColumnWidth(b)}function ib(a,b){return a&&a.getViewportLeftColumn(b)}function jb(a,b){return a&&a.getViewportTopRow(b)}x.CommentChanged="CommentChanged",function(a){a[a.active=1]="active",a[a.edit=2]="edit",a[a.normal=3]="normal"}(La=b.CommentState||(b.CommentState={})),function(a){a[a.alwaysShown=1]="alwaysShown",a[a.hoverShown=2]="hoverShown"}(Ma=b.DisplayMode||(b.DisplayMode={})),Na=function(){function a(a,b,c,d){var e=this;arguments.length<=1?e.top=e.right=e.bottom=e.left=a||0:(e.top=a,e.right=b,e.bottom=c,e.left=d)}return a.prototype.clone=function(){var b=this;return new a(b.top,b.right,b.bottom,b.left)},a.prototype.toString=function(){var a=this,b="",c=[O,P,Q,N];return c.forEach(function(c){b+=a[c]+aa+pa}),b.trim()},a}(),b.Padding=Na,Oa=function(){function a(a){var b=this;b.nT=-1,b.oT=-1,b.text(a||""),b.zIndex(na)}return a.prototype.clone=function(){var b=this,c=new a;return Qa.forEach(function(a){var d=b[a]();b[a].isDefault&&b[a].isDefault(d)||c[a](d&&d.clone?d.clone():d)}),c.kj=b.kj,c.nT=b.nT,c.oT=b.oT,c},a.prototype.toJSON=function(){var a=this,b={rowIndex:a.nT,colIndex:a.oT};return Qa.forEach(function(c){var d=a[c]();a[c].isDefault&&a[c].isDefault(d)||(b[c]=d&&d.clone?d.clone():d)}),b},a.prototype.fromJSON=function(a,b){if(a){var c=this;Qa.forEach(function(b){var d=a[b];d!==j&&("location"===b?c.location(new f.Point(d.x,d.y),!1):"padding"===b?c.padding(new Na(d.top,d.right,d.bottom,d.left),!1):c[b](d,!1))}),a.rowIndex!==j&&(c.nT=a.rowIndex),a.colIndex!==j&&(c.oT=a.colIndex)}},a}(),b.Comment=Oa,Pa={},Qa=[];function kb(a,b,c){return Qa.push(a),e.Ul.Pl(a,b,lb(a),c)}function lb(a){var b=a;return function(a,c){var d=this,e=d.kj;e&&(e.ITa.UUa({type:"property",comment:d,name:b,value:c}),e.Xq<=0&&e.RP(),e.Wq(x.CommentChanged,{sheet:e,sheetName:e.name(),comment:d,propertyName:b}))}}Ra=[[la,""],["location",Za(9,-18)],[R,160,function(a){return a>0}],[S,100,function(a){return a>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(a){return/^\d+pt$/.test(a)&&parseInt(a,10)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(a){return"boolean"==typeof a&&this.dynamicMove()}],["dynamicMove",!0,function(a){return a||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(a){return a>=0&&a<=1}],["borderWidth",1,function(a){return a>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1]],Ra.forEach(function(a){Pa[a[0]]=kb(a[0],a[1],a[2])}),Sa=Pa.zIndex,Pa.zIndex=function(){var a,b,c=Sa.apply(this,arguments);return 0===arguments.length&&c===na&&(a=this.kj.comments.wTa,b=this.mi,c=na-(a-1-b)),c},q(Oa.prototype,Pa);function mb(a,b,c,d,e){var f=$a(b,c,d,d);f.cursor=e,a.push(f)}function nb(a,b,c,d){f.GC$(a.DT).css(b,c),f.GC$(a.ET).css(b,d)}function ob(a,b){var c,d=a.length,e=0;for(c=0;c<d;c++)e+=A(a[c],b);return e}function pb(a,b){a&&a.RF(b)}Ta=function(){function a(a,b){var c,d=this,e=a&&a.kj;d.WE=1,d.aS=1,d.kT=a,d.vT(),d._zoomFactor=e.zoom(),d.wT=b,d.BF=b.xT,d.ad(),c=d.yT(d.zT(),a.width(),a.height()),d.AT=Za(c.x,c.y),d.BT(),d.CT()}return a.prototype.ad=function(){var b=this,c=b.kT.kj;b.FT=ia+"floatBlockCanvas",b.GT=ia+"host-container",b.HT=ia+"host",b.IT=ia+"lineCanvas",b.JT=r(ba),f.GC$(b.JT).addClass(ia+"floatBlockCanvas-container").css([T,V,Z],[U,Y,$]),b.DT=r("canvas"),v.Kn(b.DT,null,c),f.GC$(b.DT).addClass(b.FT).css([N,O,T],[0,0,U]),b.ET=r(ba),f.GC$(b.ET).addClass(b.GT).css([T,Z,V],[U,$,Y]),b.qo=r(ba),f.GC$(b.qo).addClass(b.HT+pa+oa).css([N,O,R,S,T,"word-wrap","word-break","white-space",V,Z,qa,Ga],[0,0,"100%","100%",U,"break-word","normal","pre-wrap",Y,$,ra,"normal"]),f.GC$(b.ET).append(b.qo),f.GC$(b.JT).append(b.DT).append(b.ET),b.KT=r(ba),f.GC$(b.KT).addClass(ia+"lineCanvas-container").css([T,V,"pointer-events"],[U,Y,"none"]),b.LT=r("canvas"),v.Kn(b.LT,i,c),f.GC$(b.LT).addClass(b.IT).css([N,P,T],[0,0,U]),f.GC$(b.KT).append(b.LT),b.MT=[],b.NT=7,b.qS=!1,b.kv=!1,a.ao(b,"init",[b.DT,b.qo])},a.prototype.OT=function(){var a=this,b=a.kT.kj;!a.PT&&b&&(a.PT=b.nQ().PT),a.PT&&(a.PT.appendChild(a.KT),a.QT(),a.PT.appendChild(a.JT),a.RT(a.DT,da),a.RT(a.ET,ea),a.ST()?a.TT():a.UT(),a.AT=a.zT(),a.VT())},a.prototype.WT=function(){var a=this;a.JT&&a.KT&&a.PT&&(a.XT(a.DT,da),a.XT(a.ET,ea),a.YT(),a.ZT(),a.$T(),f.GC$(a.JT).remove(),f.GC$(a.KT).remove())},a.prototype._T=function(){return this.kT.width()*this._zoomFactor},a.prototype.aU=function(){return this.kT.height()*this._zoomFactor},a.prototype.zT=function(){var a=this,b=a.kT;return b!==a.wT.bU||b.commentState()!==La.normal||b.ignoreDefaultLocation()?a.cU(b.location()):(b._3=a.cU(Za(9,-18)),b._3)},a.prototype.cU=function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,h=Za(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==i&&void 0!==b.x&&b.y!==i&&void 0!==b.y&&ab(b)&&_a(b)&&(c=f.am(),h.x=b.x+ab(b)+a.x*g-c.Br,h.y=b.y+a.y*g-c.Cr)),h},a.prototype.dU=function(a,b,c,d,e){var f,g,h,k,l=this,m=$a(0,0,0,0),n=a.am(),o=jb(a,d),p=ib(a,e),q=l._zoomFactor,r=z(a,p,c,!1);return p===a.qq&&(r+=a.eCb),f=z(a,o,b,!0),o===a.lq&&(f+=a.cCb),b>=o?m.y=f:m.y=-f,c>=p?m.x=r:m.x=-r,g=a.getSpan(b,c),g!==j&&g!==i?(m.height=z(a,b,b+g.rowCount,!0),m.width=z(a,c,c+g.colCount,!1)):(m[S]=gb(a,b)*q,m[R]=hb(a,c)*q),m.x+=n.Br,m.y+=n.Cr,h=n.hs,k=n.fs,1===d?m.y+=k:2===d&&(m.y+=k+n.jr),1===e?m.x+=h:2===e&&(m.x+=h+n.er),m},a.prototype.eU=function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,h=Za(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==i&&b.x!==j&&b.y!==i&&b.y!==j&&ab(b)&&_a(b)&&(c=f.am(),h.x=(a.x-(b.x+ab(b)-c.Br))/g,h.y=(a.y-(b.y-c.Cr))/g)),h},a.prototype.fU=function(){var a=this;a.AT=a.zT(),a.BT(),a.CT(),a.VT()},a.prototype.gU=function(){var a=this;a.AT=a.zT(),a.CT()},a.prototype.hU=function(){var a,b=this,c=b.kT;c.dynamicMove()?c.dynamicSize()?b.iU():(b.jU(),b.CT()):(b.BT(),b.CT(),a=b.eU(b.AT===c._3?b.zT():b.AT),c.location(a))},a.prototype.qT=function(){var a=this;a.AT=a.zT(),a.VT()},a.prototype.jU=function(){var a=this,b=a.kT,c=a.kU();a.AT=c,b.location(a.eU(c),!1),a.VT()},a.prototype.kU=function(){var a,b,c,d,e,f,g,h=this,i=h.kT,j=i&&i.kj,k=h._zoomFactor,l=ib(j,h.aS),m=jb(j,h.WE),n=0;for(a=0;a<h.aS;a++)n+=j.getViewportWidth(a);for(b=z(j,l,h.lU,!1),l<h.lU?n+=b:n-=b,c=hb(j,h.lU),c<h.mU&&(h.mU=c),n+=h.mU*k,d=0,e=0;e<h.aS;e++)d+=j.getViewportHeight(e);return f=z(j,m,h.nU,!0),m<h.nU?d+=f:d-=f,g=gb(j,h.nU),g<h.oU&&(h.oU=g),d+=h.oU*k,Za(n,d)},a.prototype.pU=function(){var a,b,c,d,e=this,f=e.kT,g=f&&f.kj,h=z(g,e.lU,e.mT,!1),i=hb(g,e.lU);i<e.mU&&(e.mU=i),a=hb(g,e.mT),a<e.qU&&(e.qU=a),h=h-e.mU+e.qU,b=z(g,e.nU,e.lT,!0),c=gb(g,e.nU),c<e.oU&&(e.oU=c),d=gb(g,e.lT),d<e.rU&&(e.rU=d),b=b-e.oU+e.rU,f.width(h),f.height(b)},a.prototype.iU=function(){var a=this;a.pU(),a.jU()},a.prototype.BT=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=ib(n,l.aS),b=jb(n,l.WE),0===l.aS?c=l.AT.x:1===l.aS?c=l.AT.x-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y:1===l.WE?d=l.AT.y-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=Za(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=hb(n,h)*o,!(f+i<e.x)){l.lU=h,l.mU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=gb(n,j)*o,!(g+k<e.y)){l.nU=j,l.oU=(e.y-g)/o;break}g+=k}}},a.prototype.CT=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=ib(n,l.aS),b=jb(n,l.WE),0===l.aS?c=l.AT.x+l._T():1===l.aS?c=l.AT.x+l._T()-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x+l._T()-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y+l.aU():1===l.WE?d=l.AT.y+l.aU()-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y+l.aU()-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=Za(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=hb(n,h)*o,!(f+i<e.x)){l.mT=h,l.qU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=gb(n,j)*o,!(g+k<e.y)){l.lT=j,l.rU=(e.y-g)/o;break}g+=k}}},a.prototype.rI=function(a,b){var c=this,d=c.kT;a<=c.nU?d.dynamicMove()&&(c.nU+=b,c.lT+=b):a>c.nU&&a<=c.lT&&d.dynamicSize()&&(c.lT+=b),c.iU()},a.prototype.tI=function(a,b){var c=this,d=c.kT;a<=c.lU?d.dynamicMove()&&(c.lU+=b,c.mT+=b):a>c.lU&&a<=c.mT&&d.dynamicSize()&&(c.mT+=b),c.iU()},a.prototype.GR=function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.nU?e<c.nU?d.dynamicMove()&&(c.nU-=b,c.lT-=b):e<c.lT&&d.dynamicMove()&&(d.dynamicSize()?c.lT-=b:c.lT-=c.nU-a+1,c.nU=a,c.oU=0):a<=c.lT&&(e<c.lT?d.dynamicSize()&&(c.lT-=b):d.dynamicSize()&&(c.lT=a,c.rU=0)),c.iU()},a.prototype.HR=function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.lU?e<c.lU?d.dynamicMove()&&(c.lU-=b,c.mT-=b):e<c.mT&&d.dynamicMove()&&(d.dynamicSize()?c.mT-=b:c.mT-=c.lU-a+1,c.lU=a,c.mU=0):a<=c.mT&&(e<c.mT?d.dynamicSize()&&(c.mT-=b):d.dynamicSize()&&(c.mT=a,c.qU=0)),c.iU()},a.prototype.VT=function(){var a,b=this,c=b.kT,d=c.kj;b.sU()&&(a=d.zoom(),b._zoomFactor!==a?(b._zoomFactor=a,b.AT=b.kU()):(b._zoomFactor=a,b.AT!==c._3||1!==c.displayMode()&&2!==c.commentState()||(b.AT=b.zT())),b.vT(),b.tU(),b.uU(),b.vU(),b.wU(),w.Ml.chrome&&b.xU())},a.prototype.tU=function(){var a=this,b=a.kT.kj,c=b.parent&&b.parent.options.useTouchLayout;c?a.NT=11:a.NT=7},a.prototype.vT=function(){var a=this,b=a.kT,c=b.kj;a.WE=c.Er(b.nT),a.aS=c.Fr(b.oT)},a.prototype.uU=function(){var a=this,b=a.kT,c=2===b.commentState()?a.BF:a.qo;a.yU(),a.zU(c),a.AU(c),a.BU(c),a.CU()},a.prototype.AU=function(a){var b=this,c=b.kT;a===b.qo&&(a.innerHTML=C.Ob(c.text()))},a.prototype.BU=function(a){var b,c,d,e,g,h,i,j,m,n,o,p,q,r,s,t,u=this,w=u.kT,x=2===w.commentState()||1===w.displayMode()?u.zT():u.AT,y=u._zoomFactor;x&&(b=u.kv?u.yT(x,w.width(),w.height()):u.yT(x),u.DU(b),c=ab(b)*y,d=_a(b)*y,e=b.x,g=b.y,h=e+c,i=g+d,j=u.NT,m=u.EU(u.WE,u.aS),e<m.x?(nb(u,N,e-m.x,e+j-m.x),c+=e-m.x,e=m.x):(nb(u,N,0,j),h>m.x+ab(m)&&(c+=m.x+ab(m)-1-h)),c=l(ab(m)-1,c),g<m.y?(nb(u,O,g-m.y,g+j-m.y),d+=g-m.y,g=m.y):(nb(u,O,0,j),i>m.y+_a(m)&&(d+=m.y+_a(m)-1-i)),d=l(_a(m)-1,d),f.GC$(u.JT).css({left:e,top:g,width:c,height:d}),n=c,o=d,v.Pn(u.DT,n,o),p=k(0,n-2*(j+w.borderWidth())),q=k(0,o-2*(j+w.borderWidth())),f.GC$(u.ET).css({width:p,height:q}),r=p,s=q,t=w.padding(),t&&(r-=Math.ceil(B(t.left)+B(t.right)),s-=Math.ceil(B(t.top)+B(t.bottom))),f.GC$(a).css({width:k(0,r),height:k(0,s)}))},a.prototype.DU=function(a){var b,c,d,e,f=this,g=f.kT,h=f.AT;a.x===h.x&&a.y===h.y&&ab(a)===g.width()&&_a(a)===g.height()||(b=f.eU(Za(a.x,a.y)),c=ab(a),d=_a(a),e=g.location(),b.x===e.x&&b.y===e.y||g.location(b,!1),c!==g.width()&&g.width(c,!1),d!==g.height()&&g.height(d,!1),g.dynamicMove()&&(f.AT=Za(a.x,a.y)))},a.prototype.CU=function(){var a=this,b=a.kT,c=b&&b.kj;bb(c)?(a.RT(a.DT,da),a.RT(a.ET,ea),a.QT(),a.UT(),a.TT()):(b.locked()?(a.XT(a.DT,da),a.FU(a.DT),a.XT(a.ET,ea),a.FU(a.ET),a.DT.style.cursor=p,a.ET.style.cursor=p):(a.RT(a.DT,da),a.RT(a.ET,ea)),b.lockText()?(a.YT(),a.FU(a.qo),a.$T(),a.FU(a.BF),(b.locked()||b.commentState()!==La.active)&&b.commentState(3),a.qo.style.cursor=b.locked()?p:H):(a.UT(),a.TT()),a.QT())},a.prototype.yU=function(){var a=this,b=a.kT,c=a.wT,d=b&&b.kj;switch(b.commentState()){case La.active:c.GU(b),a.ST()&&a.HU(),d.getSelections().length>0&&d.EJ(),u.Zl(d);break;case La.edit:c.GU(b),a.ST()||a.IU(),d.getSelections().length>0&&d.EJ(),u.Zl(i);break;case La.normal:b===c.JU()&&(c.vQ(),0===d.getSelections().length&&d.GJ())}},a.prototype.zU=function(a){var b,c,g,h,i;function j(a,b,c){var e,f;return c?(e=d.Common.pc,f=e.ec(a),f.a=b,e.bc(f)):a}b=this,c=b.kT,g=f.GC$(a),g.css("font-family",c.fontFamily()).css("font-style",c.fontStyle()).css("font-size",parseInt(c.fontSize(),10)*b._zoomFactor+"pt").css("font-weight",c.fontWeight()),g.css("text-decoration",e.To.So(c.textDecoration())),h={0:"left",1:"center",2:"right",3:"general"},g.css("text-align",h[c.horizontalAlign()]),c.padding()?g.css(_,""+c.padding()):g.css(_,"0px"),g.css("background-color",j(c.backColor(),c.opacity(),a===b.qo)).css("color",c.foreColor()),f.GC$(b.ET).css("border-width",c.borderWidth()).css("border-style",c.borderStyle()).css("border-color",c.borderColor()),i=b.wT.KU(c),f.GC$(b.KT).css(X,i),f.GC$(b.JT).css(X,i)},a.prototype.xU=function(){var a,b,c,d=this,e=this.kT.kj,g=f.GC$(d.ET);e&&g&&(a=e.Vs(),b=a.left-Math.floor(a.left)>=.5?.5:0,c=a.top-Math.floor(a.top)>=.5?.5:0,g.css(N,B(g.css(N))+b),g.css(O,B(g.css(O))+c))},a.prototype.vU=function(){var a,b,c,d,e,g,h,i,j,k=this,m=k.kT,n=m.kj,p=k.dU(n,m.nT,m.oT,k.WE,k.aS),q=n.am(),r=p.x+ab(p)-q.Br,s=p.y-q.Cr,t=Za(r,s),u=f.GC$(k.JT).position(),w=f.GC$(k.ET).position(),x=f.GC$(k.ET);a=u.left+w.left>t.x?Za(u.left+w.left,u.top+w.top):u.top+w.top+x.height()<t.y?Za(u.left+w.left+x.width(),u.top+w.top+x.height()):Za(u.left+w.left+x.width(),u.top+w.top),b=k.NT,c=o(t.x-a.x)+2*b,d=o(t.y-a.y)+2*b,e=l(t.x,a.x)-b,g=l(t.y,a.y)-b,h=e+c,i=g+d,j=k.EU(k.WE,k.aS),e<j.x&&(c-=j.x-e,e=j.x),h>j.x+ab(j)&&(c-=h-(j.x+ab(j))),c=l(ab(j),c),g<j.y&&(d-=j.y-g,g=j.y),i>j.y+_a(j)&&(d-=i-(j.y+_a(j))),d=l(_a(j),d),f.GC$(k.KT).css(N,e).css(O,g).css(R,c).css(S,d),v.Pn(k.LT,c,d),t.x=t.x-e,t.y=t.y-g,a.x=a.x-e,a.y=a.y-g,k.LU(t,a)},a.prototype.LU=function(a,b){var c,d,e,f=this;f.MU||(f.MU=f.LT.getContext("2d")),c=f.MU,d=f.kT.borderColor(),c.strokeStyle=d,c.clearRect(0,0,v.Nn(f.LT),v.On(f.LT)),c.beginPath(),c.moveTo(a.x,a.y),c.lineTo(b.x,b.y),c.stroke(),c.save(),D.Dn(c,a.x,a.y),c.fillStyle=d,c.beginPath(),e=n(b.y-a.y,b.x-a.x),c.rotate(e),c.moveTo(0,0),c.lineTo(7,-4),c.lineTo(7,4),c.lineTo(0,0),c.fill(),D.Dn(c,-a.x,-a.y),c.closePath(),c.restore()},a.prototype.wU=function(){var a,b,c,d,e,g,h,i=this,j=i.kT,k=j.kj;i.NU=i.kT.commentState(),i.OU||(i.OU=i.DT.getContext("2d")),a=i.OU,b=v.Nn(i.DT),c=v.On(i.DT),d=f.GC$(i.ET).outerWidth(),e=f.GC$(i.ET).outerHeight(),g=i.NT,a.clearRect(0,0,b,c),i.kT.showShadow()&&(i.QU(a,b,c),h=2*(g+2),a.clearRect(g,g,b-h,c-h),i.PU(a,g,d,e)),bb(k,j)&&i.RU(a,g,b,c,d,e),a.restore()},a.prototype.PU=function(a,b,c,d){a.fillRect(b+2,d+b,c,2),a.fillRect(c+b,b+2,2,d)},a.prototype.QU=function(a,b,c){var d,e,f;switch(this.NU){case La.active:for(a.beginPath(),e=0;e<c;e++)for(d=e%2===0?1:3;d<b;)a.moveTo(d,e),a.lineTo(d+1,e+1),d+=4;a.stroke(),a.closePath();break;case La.edit:for(a.beginPath(),d=0,e=0,f=4;d<b+c;)a.moveTo(d+f,0),a.lineTo(0,e+f),d+=f,e+=f;a.stroke(),a.closePath()}},a.prototype.RU=function(a,b,c,d,e,g){var h=this,j=h.MT;h.NU!==La.active&&h.NU!==La.edit||(j.splice(0,j.length),mb(j,0,0,b,"nw"+Fa),mb(j,c-b,0,b,"ne"+Fa),mb(j,0,d-b,b,"sw"+Fa),mb(j,c-b,d-b,b,"se"+Fa),g>=3*b?(mb(j,0,m(d/2-b/2),b,"w"+Fa),mb(j,c-b,m(d/2-b/2),b,"e"+Fa)):(j.push(i),j.push(i)),e>=3*b?(mb(j,m(c/2-b/2),0,b,"n"+Fa),mb(j,m(c/2-b/2),d-b,b,"s"+Fa)):(j.push(i),j.push(i)),a.restore(),a.fillStyle="white",a.strokeStyle="#939393",a.lineWidth=1,D.Dn(a,.5,.5),f.GC$.each(j,function(b,c){if(c){var d=c.x,e=c.y,f=ab(c),g=_a(c);a.beginPath(),a.fillRect(d,e,f-1,g-1),a.strokeRect(d,e,f-1,g-1),a.stroke(),a.closePath()}}),D.Dn(a,-.5,-.5))},a.prototype.SU=function(){var a,b,c,d=this,e=d.EU(d.WE,d.aS);d.TU?f.GC$(d.TU).remove():d.TU=r(ba),a=f.GC$(d.TU),b=f.GC$(d.ET),a.addClass("gc-spread-moveResizeContainer").css([T,N,O,R,S,"border"],[U,d.AT.x+d.NT-e.x,d.AT.y+d.NT-e.y,b.outerWidth()-2,b.outerHeight()-2,"gray solid thin"]),d.UU?f.GC$(d.UU).remove():d.UU=r(ba),c=f.GC$(d.UU),c.bind("mousemove",function(a){d.BD(a)}).bind(K,function(a){d.CD(a)}).css([T,V,O,N,R,S,"background",X],[U,Y,e.y,e.x,ab(e),_a(e),"rgba(255,255,255,0.01)",901]),c.append(d.TU),d.PT&&d.PT.appendChild(d.UU)},a.prototype.VU=function(a){var b,c,d,e,g,h,i,j,k,l=this,m=l.NT,n=l._zoomFactor,o=l.wT,p=o.WU;if(p.XU){if(b=l.YU(),c=a.pageX/n-p.x+b.x,d=a.pageY/n-p.y+b.y,0===c&&0===d)return;e=l.EU(l.WE,l.aS),h=f.GC$(l.TU),p.ZU<0?(i=p.$U.x+c,j=p.$U.y+d,g=l.cU(Za(i,j)),h.css([N,O],[g.x+m-e.x,g.y+m-e.y])):(k=l._U(c,d,p.ZU),g=l.cU(Za(k.x,k.y)),h.css([N,O,R,S],[g.x+m-e.x,g.y+m-e.y,ab(k)*n-2*m-2,_a(k)*n-2*m-2]))}},a.prototype.IU=function(){var a,b=this,c=b.kT;b.ST()||(a=b.wT.xT,f.GC$(b.qo).remove(),b.YT(),f.GC$(a).remove(),f.GC$(b.ET).append(a),b.aV(a),b.BU(a),f.GC$(a).focus(),a.selectionStart=a.value.length,b.TT(),2!==c.commentState()&&c.commentState(2))},a.prototype.HU=function(){var b,c=this,d=c.kT,e=d.kj;c.ST()&&(b=c.wT.xT,c.$T(),f.GC$(b).remove(),f.GC$(c.ET).append(c.qo),c.aV(c.qo),c.UT(),a.ao(c,"detachEditor",c.qo),2===d.commentState()&&d.commentState(3),f.GC$(b).val()!==d.text()&&e.wu().execute({cmd:"changeComment",sheetName:e.name(),row:d.nT,col:d.oT,oldValue:d.text(),newValue:f.GC$(b).val(),propertyName:la}))},a.prototype.bV=function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportHeight(a):1===a&&(d=z(c,c.getViewportBottomRow(0)+1,jb(c,2)+1,!0)),d},a.prototype.cV=function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportWidth(a):1===a&&(d=z(c,c.getViewportRightColumn(0)+1,ib(c,2)+1,!1)),d},a.prototype.EU=function(a,b){var c=this,d=c.kT.kj,e=d.am(),f=e.Ft(a,b);return 0===a&&0===b||0===a&&2===b||2===a&&0===b||2===a&&2===b?f=$a(0,0,e.hs+e.er+e.js,e.fs+e.jr+e.gs):0===a&&1===b||2===a&&1===b?f=$a(e.hs,0,e.er,e.fs+e.jr+e.gs):1===a&&0===b||1===a&&2===b?f=$a(0,e.fs,e.hs+e.er+e.js,e.jr):1===a&&1===b&&(f=$a(e.hs,e.fs,e.er,e.jr)),f},a.prototype.aV=function(a){var b=this,c=b.kT,d=f.GC$(a);a!==b.BF&&a!==b.qo||(a===b.BF?a.value=c.text():a.innerHTML=C.Ob(c.text()),d.css([ua,va,wa,xa,ya,za,Aa,Ba],[c.fontFamily(),c.fontStyle(),c.fontSize(),c.fontWeight(),c.foreColor(),c.backColor(),c.horizontalAlign(),c.textDecoration()]),c.padding()?d.css(_,""+c.padding()):d.css(_,"0px"))},a.prototype.sU=function(){return!(!this.JT||!this.JT.parentNode)},a.prototype.ST=function(){var a=this;return a.sU()&&a.kT===a.wT.JU()&&f.GC$(a.ET).find(Ca).length>0},a.prototype.dV=function(){var a,b=this,c=b.kT.kj,d=i;return b.sU()&&(a=c.am(),d=$a(b.AT.x+a.zr+a.Br,b.AT.y+a.Ar+a.Cr,b._T(),b.aU())),d},a.prototype.eV=function(){var a,b,c,d,e,f,g,h=this,j=h.kT,k=h._zoomFactor;return h.sU()&&(a=h.dV())?(b=void 0,c=void 0,d=void 0,e=void 0,f=(h.NT+j.borderWidth())*k,g=f,b=a.x+f,c=a.y+g,d=ab(a)-2*f,e=_a(a)-2*g,$a(b,c,d,e)):i},a.prototype.fV=function(a){var b,c=this,d=c.kT,e=d.kj,f=a.target,g=c.wT.WU,h=f.style,i=p;g.XU?f[ja]!==c.HT&&f[ja]!==c.FT&&f[ja]!==c.IT&&f[ja]!==ia+"floatPanel"||(i=g.ZU>=0?"crosshair":H):f[ja]===c.HT?!bb(e)&&d.lockText()?d.locked()||(i=H):i=la:f[ja]!==c.FT&&f[ja]!==c.GT||bb(e,d)&&(b=c.gV(a),i=b>=0&&b<c.MT.length?c.MT[b].cursor:H),h[ka]=i},a.prototype.hV=function(b){var c,d=this,e=d.kT,f=e&&e.kj;if(f.endEdit()&&(c={e:b,r:i},a.ao(d,"preProcessMouseDownEdit",c),!c.r))return f.Wq(x.FloatingElementSelected,{type:"comments"}),d.wT.GU(e),e.commentState(2),d.CD(b),y(b)},a.prototype.iV=function(b){var c,d,e,f,g,h=this,j=h.kT,k=j&&j.kj,l=h._zoomFactor,m=h.wT,n=m.WU;k.endEdit()&&(c={e:b,r:i},a.ao(h,"preProcessMouseDownDragResize",c),c.r||(k.Wq(x.FloatingElementSelected,{type:"comments"}),n.x=b.pageX/l,n.y=b.pageY/l,n.$U=$a(j.location().x,j.location().y,j.width(),j.height()),n.ZU=h.gV(b),h.tC(),n.XU=!0,h.fV(b),m.GU(j),j.commentState(La.active),bb(k,j)&&(h.eS={},h.eS.jV=jb(k,h.WE),h.eS.kV=ib(k,h.aS),h.SU(),n.ZU<0?h.qS=!0:h.kv=!0),d=k.mm,e=k.Vs(),f=Za(b.pageX-e.left,b.pageY-e.top),g=k.hitTest(f.x,f.y),d.rG={KG:g.rowViewportIndex,MG:g.colViewportIndex,sG:g.hitTestType},d.$F=f,d.qG(),d.lV=!0,b.stopPropagation()))},a.prototype.yT=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,p=n.kT,q=p&&p.kj,r=n.NT,s=n._zoomFactor,t=n.aS,u=n.WE,v=n.EU(u,t),w=void 0!==b?b*s:n._T(),x=void 0!==c?c*s:n.aU(),y=a.x,A=a.y,B=q.am(),C=n.dU(q,0,0,u,t),D=a.x+(0-(C.x-B.Br))+w-r,E=a.y+(0-(C.y-B.Cr))+x-r,F=0,G=0,H=0,I=0;return 0===t?(F=0-r,H=ab(B)-B.Br):1===t?(d=z(q,q.getViewportRightColumn(0)+1,ib(q,1),!1),F=v.x-r-d,e=n.cV(2),H=e):2===t&&(F=0-r,H=0),y<F&&(n.kv?w-=F-y:D+=F-y,y=F),1!==t&&2!==t||(H+=z(q,0,q.getColumnCount(),!1,D)),D>H&&(n.kv?w-=D-H:n.qS?y-=D-H:(f=n.wT.bU&&!p.ignoreDefaultLocation()?9:p.location().x,g=2*o(f)+hb(q,p.oT)+p.width(),h=y-g,h>F?y=h:y<H?w-=D-H:(h=y-g,i=D-g,i>F?h<F?(w-=F-h,y=F):y=h:(h=y-(D-H),
h<F?(w-=F-h,y=F):y=h)))),0===u?(G=0-r,I=_a(B)-B.Cr):1===u?(j=z(q,q.getViewportBottomRow(0)+1,jb(q,1),!0),G=v.y-r-j,k=n.bV(2),I=k):(G=0-r,I=0),A<G&&(n.kv?x-=G-A:E+=G-A,A=G),1!==u&&2!==u||(I+=z(q,0,q.getRowCount(),!0,E)),E>I&&(n.kv?x-=E-I:n.qS?A-=E-I:E>I&&(l=E-I,m=A-l,m<G?(x-=G-m,A=G):A=m)),$a(y,A,w/s,x/s)},a.prototype.YU=function(){var a=this,b=a.kT.kj,c=a.eS,d=c.jV,e=c.kV,f=jb(b,a.WE),g=ib(b,a.aS),h=z(b,d,f,!0),i=z(b,e,g,!1),j=e<g?i:-i,k=d<f?h:-h;return Za(j,k)},a.prototype.mV=function(a){var b,c,d,e,f,h,i,j,k,l,m=this,n=m.kT,o=n&&n.kj,p=m._zoomFactor,q=m.wT,r=q.WU,s=g.ChangeComment;if(r.XU){if(b=m.YU(),c=a.pageX/p-r.x+b.x,d=a.pageY/p-r.y+b.y,0===c&&0===d)return;e=void 0,f=void 0,r.ZU<0?(i=r.$U.x+c,j=r.$U.y+d,e=m.cU(Za(i,j)),f=m.yT(e),h=m.eU(Za(f.x,f.y)),h.x===n.location().x&&h.x===n.location().y||o.wu().execute({cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.location().clone(),newValue:h,propertyName:"location"})):(n.autoSize(!1),k=m._U(c,d,r.ZU),e=m.cU(Za(k.x,k.y)),f=m.yT(e,ab(k),_a(k)),h=m.eU(Za(f.x,f.y)),l=[],h.x===n.location().x&&h.y===n.location().y||l.push(new s(o,{cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.location().clone(),newValue:h,propertyName:"location"})),ab(f)!==n.width()&&l.push(new s(o,{cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.width(),newValue:f.width,propertyName:R})),_a(f)!==n.height()&&l.push(new s(o,{cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.height(),newValue:f.height,propertyName:S})),l.length>0&&o.wu().execute({cmd:"changeCommentTransaction",sheetName:o.name(),commands:l}))}},a.prototype.BD=function(b){var c,d,e,f,g,h=this,j=h.kT.kj,k={e:b,r:i};if(a.ao(h,"preProcessMouseMove",k),!(k.r||(this.fV(b),j.getSelections()&&j.getSelections().length>0)))return c=h.wT,d=b.target,e=j.mm,f=j.Vs(),g=Za(b.pageX-f.left,b.pageY-f.top),d&&c.WU.XU&&(h.TU&&h.VU(b),1===h.WE&&(e.$F.y=g.y),1===h.aS&&(e.$F.x=g.x),e.NG()),y(b)},a.prototype.CD=function(b){var c,d,e,g=this,h=g.kT.kj,j={e:b,r:i};if(a.ao(g,"preProcessMouseUp",j),!(j.r||h.getSelections()&&h.getSelections().length>0))return c=b.target,d=g.wT,e=h.mm,e.lV=!1,e.RG(),c&&(g.mV(b),g.UU&&(f.GC$(g.UU).remove(),g.UU=null,g.qS=!1,g.kv=!1),g.uC(),d.WU.XU=!1,g.fV(b)),y(b)},a.prototype.gV=function(a){var b,c,d,e,g,h=this,i=h.MT;if(i.length>0&&(h.NU===La.active||h.NU===La.edit))for(b=h.DT,c=a.pageX-f.GC$(b).offset().left,d=a.pageY-f.GC$(b).offset().top,e=0;e<i.length;e++)if(g=i[e],g&&g.contains(c,d))return e;return-1},a.prototype._U=function(a,b,c){var d,e,f=this,g=-1,h=-1;switch(c){case 0:g=0,h=0;break;case 1:g=2,h=0;break;case 2:g=0,h=2;break;case 3:g=2,h=2;break;case 4:g=0,h=1;break;case 5:g=2,h=1;break;case 6:g=1,h=0;break;case 7:g=1,h=2}return d=f.nV(a,g),e=f.oV(b,h),$a(d.x,e.y,d.w,e.h)},a.prototype.nV=function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=ab(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.x,h>=0?0===b&&(c+=a):0===b?c+=ab(g.$U)-f:2===b&&(c+=h),d=ab(g.$U),1!==b&&(d=o(h)+f),{x:c,w:d}},a.prototype.oV=function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=_a(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.y,h>=0?0===b&&(c+=a):0===b?c=_a(g.$U)-f:2===b&&(c+=h),d=_a(g.$U),1!==b&&(d=o(h)+f),{y:c,h:d}},a.prototype.FU=function(a){var b,c,d=this,e=d.kT.kj;if(a){switch(b=j,a){case d.DT:b=da;break;case d.ET:b=ea;break;case d.KT:b=fa;break;case d.qo:b=ga;break;case d.BF:b=ha}b&&(f.GC$(a).unbind(L+b).unbind(M+b),c=function(a){e.RF(a),y(a)},f.GC$(a).bind(L+b,c).bind(M+b,c))}},a.prototype.RT=function(a,b){var c,d=this,e=d.kT,g=e&&e.kj;d.XT(a,b),c=function(a){pb(g,a)},f.GC$(a).bind(I+b,function(a){d.iV(a)}).bind(J+b,function(a){d.BD(a)}).bind(K+b,function(a){d.CD(a)}).bind(L+b,c).bind(M+b,c)},a.prototype.XT=function(a,b){f.GC$(a).unbind(b)},a.prototype.QT=function(){var a,b,c=this,d=c.kT,e=d&&d.kj,g=c.wT;c.ZT(),e&&(a=e.Vs(),b=function(a){e.RF(a)},f.GC$(c.LT).bind(I+Da,function(b){var d,h,i=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top);i?(d=i.comment,h=g.pT(d),i.area===sa?h.hV(b):i.area===ta&&h.iV(b),f.GC$(h.JT).css(X,parseInt(f.GC$(c.KT).css(X)+1,10))):e.OF(b)}).bind(J+Da,function(b){var d,f,h,j=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top),k=c.LT.style;j?(d=j.comment,f=g.pT(d),f.BD(b),j.area===sa?k.cursor=la:j.area===ta&&(k.cursor=H)):(e.PF(b),c.wT.tT(i),h=e.Ws(),h&&(k.cursor=h.style.cursor))}).bind(K+Da,function(b){var c,d,f=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top);f?(c=f.comment,d=g.pT(c),d.CD(b)):e.QF(b)}).bind("dblclick"+Da,function(a){e.TF(a)}).bind(L+Da,b).bind(M+Da,b))},a.prototype.ZT=function(){var a=this;f.GC$(a.LT).unbind(Da)},a.prototype.UT=function(){var a,b=this,c=b.kT,d=c&&c.kj;c.commentState()!==La.edit&&b.qo&&(b.YT(),a=function(a){pb(d,a)},f.GC$(b.qo).bind(I+ga,function(a){b.hV(a)}).bind(J+ga,function(a){b.BD(a)}).bind(K+ga,function(a){b.CD(a)}).bind(L+ga,a).bind(M+ga,a))},a.prototype.YT=function(){var a=this,b=a.kT;b.commentState()!==La.edit&&a.qo&&f.GC$(a.qo).unbind(ga)},a.prototype.TT=function(){var a,b=this,c=b.kT,d=c&&c.kj,e=b.BF;c.commentState()===La.edit&&e&&(this.$T(),a=function(a){d&&(d.RF(a),w.nl(a))},f.GC$(e).bind(I+ha,function(a){a.stopPropagation()}).bind(J+ha,function(a){a.stopPropagation()}).bind(K+ha,function(a){a.stopPropagation()}).bind(L+ha,a).bind(M+ha,a).bind("input"+ha,function(){c.autoSize()&&b.pV()}).bind("keydown"+ha,function(a){27!==a.keyCode&&9!==a.keyCode||(c.commentState(La.active),y(a),u.Zl(d))}).bind("focusout"+ha,function(){f.GC$(e).val()!==c.text()&&d.wu().execute({cmd:"changeComment",sheetName:d.name(),row:c.nT,col:c.oT,oldValue:c.text(),newValue:f.GC$(e).val(),propertyName:la})}))},a.prototype.pV=function(){var a,b,c,d,e,g,h,i,j,l,m,n,o,p,q,r,s=this,t=s.kT,u=t&&t.kj;if(t.commentState()===La.edit?(a=s.BF,b=a.value.split("\n")):(a=s.qo,b=C.Pb(a.innerHTML).split("\n")),c=f.GC$(a).height(),d=f.GC$(a).width(),h=0,i=a.style,j="",i.font?(h=ob(b,j),j+=i.font):(t.fontStyle()&&(j+=pa+t.fontStyle()),t.fontWeight()&&(j+=pa+t.fontWeight()),t.fontSize()&&(j+=pa+t.fontSize()),t.fontFamily()&&(j+=pa+t.fontFamily()),h=ob(b,j)),l=h,m=5,b&&b.length>0){for(e=l,n=0,o=0;o<b.length;o++)p=u.rt(b[o],j),n<p&&(n=p);g=k(n,m)}else e=l,g=m;f.GC$(a).css(S,e).css(R,g),2===t.commentState()&&t.text(a.value),s.qV=!0,q=e-c,0!==q&&t.height(t.height()+q),r=g-d,0!==r&&t.width(t.width()+r),s.qV=!1},a.prototype.$T=function(){var a=this,b=a.BF;b&&f.GC$(b).unbind(ha)},a.prototype.tC=function(){var a=this,b=a.wT.WU;b.XU||(f.GC$(E).bind(J+Ea,function(b){a.BD(b)}).bind(K+Ea,function(b){a.CD(b)}),b.XU=!0)},a.prototype.uC=function(){var a=this.wT.WU;a.XU&&(a.XU=!1,f.GC$(E).unbind(Ea))},a}(),b.GV=Ta,e.Zn(Ta),Ua=function(){function a(a){var b=this;b.kj=a,b.WU={XU:!1,x:0,y:0,$U:i,ZU:-1},b.xT=i,b.bU=i,b.rV=i,b.sV=[],b.wTa=0,b.jT=[],b.tV(),b.uV(),b.xn={}}return a.prototype.dispose=function(){var a=this,b=a.all();b.forEach(function(b){a.hT(b)}),a.Uka()},a.prototype.add=function(a,b,c){var d,e,g=this,h=g.kj,j=h.getSpan(a,b);return!j||j.row===a&&j.col===b?(d=g.get(a,b),e="string"==typeof c?new Oa(c):c,g.Cz(a,b,e),h.Bq("comment",a,b,f.SheetArea.viewport,d,e),e):i},a.prototype.Cz=function(a,b,c){var d=this,e=d.kj,f=d.sV;d.vV(a,b),c&&(e.ITa.UUa({type:"add",row:a,col:b}),c.nT=a,c.oT=b,c.kj=e,f.push(c),c.mi=d.wTa,d.wTa++,d.JUa(a,b,c),e.$p())},a.prototype.get=function(a,b){return this.xn[a+"_"+b]||i},a.prototype.JUa=function(a,b,c){this.xn[a+"_"+b]=c},a.prototype.VUa=function(a,b,c){var d=a.nT,e=a.oT;this.get(d,e)===a&&this.JUa(d,e,j),this.kj.ITa.UUa({type:"rowcol",comment:a,row:d,col:e}),a.nT=b,a.oT=c,this.JUa(b,c,a)},a.prototype.remove=function(a,b){var c=this,d=c.vV(a,b),e=c.kj;d&&(e.Bq(t,a,b,f.SheetArea.viewport,d,j),e.$p())},a.prototype.vV=function(a,b){var c=this,d=c.kj,e=c.get(a,b);return e&&(d.ITa.UUa({type:"remove",row:a,col:b,comment:e}),c.hT(e),s.Fb(c.sV,e),s.Fb(c.jT,c.pT(e)),c.JUa(a,b,j)),e},a.prototype.clear=function(a){var b,c,d,e,f=this,g=f.kj,h=f.sV;for(g.suspendPaint(),b=h.length-1;b>=0;b--)c=h[b],d=c.nT,e=c.oT,(!a||d>=a.row&&d<a.row+a.rowCount&&e>=a.col&&e<a.col+a.colCount)&&f.remove(d,e);g.resumePaint()},a.prototype.all=function(){return this.sV.concat()},a.prototype.qUa=function(a,b,c,d,e,f){(a||d)&&(a&&this.VUa(a,e,f),d&&this.VUa(d,b,c))},a.prototype.getOuterContainer=function(a){var b=this.pT(a);return b?b.JT:i},a.prototype.tV=function(){var a=r(Ca);f.GC$(a).addClass("gc-comment-editor").css(N,0).css(O,0).css(T,U).css("margin",0).css(_,0).css("word-wrap","break-word").css("word-break","normal").css(V,Y).css("resize","none").css("outline","none").css("border","0px").css(Z,$).css(Ga,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.xT=a},a.prototype.uV=function(){var a=this,b=a.kj;b&&(b.Fu(x.ColumnChanged+ca,function(b,c){var d=c.propertyName;d!==R&&"isVisible"!==d||a.wV()}),b.Fu(x.RowChanged+ca,function(b,c){var d=c.propertyName;d!==S&&"isVisible"!==d||a.wV()}),b.Fu(x.ColumnWidthChanged+ca,function(){a.wV()}),b.Fu(x.RowHeightChanged+ca,function(){a.wV()}),b.Fu(x.CommentChanged+ca,function(b,c){var d,e,f,g;c&&(d=c.propertyName,e=c.comment,f=a.pT(e),f&&(g=["autoSize","text","fontFamily","fontStyle","fontSize","fontWeight","padding"],"location"===d?f.fU():d===R||d===S?f.gU():g.indexOf(d)>=0&&e.autoSize()&&!f.qV&&f.pV()))}))},a.prototype.Uka=function(){var a=this,b=a.kj;b&&b.Gu(ca)},a.prototype.pT=function(a){var b,c,d=this,e=d.jT;if(a)for(b=0;b<e.length;b++)if(c=e[b],c.kT===a)return c;return i},a.prototype.iT=function(){return 0===this.sV.length},a.prototype.xV=function(){var a,b,c,d=this,e=d.sV;if(e.length>0){for(a=e[0].zIndex(),b=1;b<e.length;b++)c=e[b],a<c.zIndex()&&(a=c.zIndex());return a}return 0},a.prototype.rI=function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.nT&&g.VUa(d,d.nT+b,d.oT);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.rI(a,b)},a.prototype.tI=function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.oT&&g.VUa(d,d.nT,d.oT+b);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.tI(a,b)},a.prototype.GR=function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,e>=a&&e<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.nT&&h.VUa(d,d.nT-b,d.oT);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.GR(a,b)},a.prototype.HR=function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,f>=a&&f<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.oT&&h.VUa(d,d.nT,d.oT-b);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.HR(a,b)},a.prototype.JU=function(){return this.rV},a.prototype.GU=function(a){var b=this;a&&a!==b.rV&&(b.vQ(),b.rV=a)},a.prototype.vQ=function(){var a,b=this,c=b.rV;c&&(a=b.pT(c),!a||a.qS||a.kv||(a.ST()&&a.HU(),c.commentState(La.normal),b.rV=i))},a.prototype.Ao=function(a){var b=this,c=b.pT(a),d=!1;c||(d=!0,c=new Ta(a,b),b.jT.push(c)),c.OT(),d&&a.autoSize()&&!c.qV&&c.pV()},a.prototype.tT=function(a){var b=this,c=b.rV;if(c)if(1===c.displayMode()){if(c.commentState()===La.edit)return}else if(c.commentState()===La.edit||c.commentState()===La.active)return;a!==b.bU&&(b.bU&&b.hT(b.bU),a&&2===a.displayMode()?b.WU.XU||a.yV||(b.bU=a,a.yV=F.setTimeout(function(){b.Ao(a)},200)):b.bU=i)},a.prototype.hT=function(a){var b=this,c=b.pT(a);c&&c.sU()&&(c.WT(),a===b.rV&&b.kj.GJ()),clearTimeout(a.yV),delete a.yV},a.prototype.zV=function(){f.GC$(this.kj.nQ().PT).show()},a.prototype.AV=function(){f.GC$(this.kj.nQ().PT).hide()},a.prototype.BV=function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.dV()))&&d.contains(b,c)},a.prototype.CV=function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.eV()))&&d.contains(b,c)},a.prototype.hitTest=function(a,b){var c,d,e=this,f=i;for(c=0;c<e.sV.length;c++)d=e.sV[c],bb(e.kj,d)&&e.BV(d,a,b)&&(f?d.zIndex()>f.zIndex()&&(f=d):f=d);return f?{x:a,y:b,comment:f,area:e.CV(f,a,b)?sa:ta}:i},a.prototype.KU=function(a){var b=this,c=b.xV();return a===b.bU?c+2:a===b.rV?c+1:a.zIndex()},a.prototype.wV=function(){this.jT.forEach(function(a){a.hU()})},a.prototype.cQ=function(){this.jT.forEach(function(a){a.qT()})},a.prototype.fromJSON=function(a,b){var c,d,e,f=this;if(a&&0!==a.length)for(f.wTa=0,c=0;c<a.length;c++)d=a[c],e=new Oa,e.fromJSON(d,b),3!==e.commentState()&&(f.rV=e),f.kj.ITa.Ky.Cz(e.nT,e.oT,e)},a.prototype.toJSON=function(){var a,b,c=this.sV;if(!c||0===c.length)return j;for(a=[],b=0;b<c.length;b++)a.push(c[b].toJSON());return 0===a.length?j:a},a}(),Va=function(){function a(a){var b=this;b.kj=i,b.oQ=!0,b.PT=b.DV(),a.appendChild(b.PT)}return a.prototype.DV=function(){var a=r(ba);return f.GC$(a).addClass("gc-comment-layoutPanel"+pa+oa).css([T,N,O,S,R,V,X,qa],[U,0,0,0,0,W,ma,ra]),a},a.prototype.rT=function(a){var b,c,d,e=this;a.ITa.Ky.iT()||(b=a.am(),f.GC$(e.PT).css(N,b.x+b.Br).css(O,b.y+b.Cr),e.kj!==a&&(e.kj&&(c=e.kj.ITa,d=c.Ky.JU(),d&&d.commentState()===La.edit&&d.commentState(La.active)),e.kj=a))},a.prototype.sT=function(a,b,c){var d,e,g=c.row,h=c.col,i=c.x,j=c.y,k=ab(c),l=_a(c),m=this;b===f.SheetArea.viewport&&m.kj&&(d=m.kj.ITa.Ky.get(g,h),d&&(e=6,a&&k>0&&l>0&&(a.save(),a.rect(i,j,k,l),a.clip(),a.fillStyle="red",a.beginPath(),a.moveTo(i+k-e,j),a.lineTo(i+k,j),a.lineTo(i+k,j+e),a.lineTo(i+k-e,j),a.fill(),a.restore())))},a.prototype.fT=function(a){var b,c,d,e,f,g,h;if(!this.oQ)return void a.AV();for(a.zV(),b=this.kj,c=a.all(),d=0;d<c.length;d++)e=c[d],f=a.pT(e),this.EV(a,e)?(1===e.displayMode()&&e===a.bU&&(a.bU=i),f&&f.sU()?f.VT():a.Ao(e)):f&&f.sU()&&a.hT(e);g=a.JU(),g&&(h=a.pT(g),h&&h.sU()&&b.getSelections().length>0&&b.ITa.do("clearSelection"))},a.prototype.EV=function(a,b){var c=a.kj;if(c&&hb(c,b.oT)&&gb(c,b.nT))switch(b.displayMode()){case 1:return!0;case 2:if(3!==b.commentState())return a&&b!==a.bU&&(a.bU=b),!0;if(b===a.bU)return!0}return!1},a}(),Wa=e.lUa,e.GC$.extend(Wa.prototype,{UUa:function(a){var b,c=this.zTa;c&&(b=c.WUa,b||(b=c.WUa=[]),b.push(a))},XUa:function(a){var b,c,d,e,f,g,h;if(a)for(b=this,c=b.Ky,d=a.length-1;d>=0;d--)e=a[d],f=e.comment,"add"===e.type?c.vV(e.row,e.col):"remove"===e.type?c.Cz(e.row,e.col,e.comment):"property"===e.type?(g=e.name,h=e.value,f[g](h)):"rowcol"===e.type&&c.VUa(f,e.row,e.col)},wyb:function(a,b,c,d){var e,f,g=this;for(e=0;e<c;e++)for(f=0;f<d;f++)0===e&&0===f||g.getCell(a+e,b+f).comment()&&g.comments.remove(a+e,b+f)}}),Wa.$n("comments",{init:function(){this.Ky=new Ua(this.kj)},undo:function(a){var b=a.WUa;b&&this.XUa(b)}}),Xa={init:function(){var a=this;a.comments=a.ITa.Ky,a.nQ=function(){var b=a.parent;if(b)return b.gT||(b.gT=new Va(b.xv())),b.gT.kj=a,a.parent.gT}},dispose:function(){var a=this.ITa.Ky;a&&a.dispose(),Ka(this,f.GC$(this.Ws()))},setHost:function(a){if(a){var b=this.ITa.Ky;b&&b.uV(),Ja(a,this)}},onLayoutChanged:function(a){var b=this,c=b.ITa.Ky,d=a.changeType,g=a.row,h=a.rowCount,i=a.col,j=a.colCount;"addRows"===d?c.rI(g,h):"deletingRows"===d?c.GR(g,h):"addColumns"===d?c.tI(i,j):"deletingColumns"===d?c.HR(i,j):a.sheetArea===f.SheetArea.viewport&&("clear"===d?4===(4&a.type)&&c.clear(new e.Range(g,i,h,j)):"addSpan"===d?cb.call(b,!0,g,i,h,j):"removeSpan"===d&&cb.call(b,!1,g,i))},paint:function(a){this.ITa.Ky.iT()||(db.call(this),this.RP(a.clipRect))},paintCell:function(a){a.isPrinting||a.sheetArea!==f.SheetArea.viewport||eb.call(this,a.ctx,a.sheetArea,a.cell)},toJson:function(a,b){var c=b&&b.ignoreStyle;c||(a.comments=this.ITa.Ky.toJSON())},fromJson:function(a,b,c){var d,e=c&&c.ignoreStyle;e||a&&(d=b?a.commentManager:a.comments,d&&this.ITa.Ky.fromJSON(d,b))},lastNonNullRowAndCol:function(){var a,b,c,d,e=0,f=0,g=this.ITa.Ky;if(g&&(a=g.jT,a&&a.length>0))for(b=0,c=a.length;b<c;b++)d=a[b],d&&d.kT&&(d.lT>e&&(e=d.lT),d.mT>f&&(f=d.mT));return{lastNonNullRow:e,lastNonNullCol:f}},clearSelection:function(){this.ITa.Ky.vQ()},processKeyDown:function(a){var b=this,c=b.ITa.Ky.JU();c&&b.mm.LH(a.e)&&(c.commentState(2),a.r=!0)}},h.$n("comments",Xa),Ya={init:function(){g.uT(this.commandManager())}},e.Workbook.$n("comments",Ya)},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},Touch:function(a,b){a.exports=GC.Spread.Sheets.Touch}});