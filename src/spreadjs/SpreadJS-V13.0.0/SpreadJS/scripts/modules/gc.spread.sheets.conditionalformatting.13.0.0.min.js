/*!
 * 
 * SpreadJS Library 13.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.ConditionalFormatting=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/conditional/conditional.entry.js")}({"./dist/plugins/conditional/conditional.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/conditional/conditional.js")),d(c("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("CalcEngine"),g=c("./dist/plugins/conditional/conditional.ns.js"),h=c("CalcEngine"),i=c("Core"),j=c("SheetsCalc"),k=c("./dist/plugins/conditional/conditionalFormatIcon.js"),l=e.GC$,m=d.Common.u,n=null,o=void 0,p="undefined",q="string",r=Math.min,s=Math.max,t=Math.abs,u=Math.floor,v=Math.ceil,w=f.Convert,x=w.Na,y=w.Pa,z=w.Th,A=d.Common.u,B=A.Db,C=A.kb,D=A.jb,E=A.Bb,F=d.Common.j.Fa,G=d.Common.q,H=d.Common.F,I=e.Ul,J=I.T$a,K=I.l_a,L=!!f,M=e.Style,N=d.Common.k,O=d.Common.pc,P=O.bc,Q=e.kf,R=e.Range,S=d.Common.l,T=d.Common.k,U=T.Fb,V=T.Cb,W=T.ac,X=f.Functions,Y=e.Rm,Z=new d.Common.ResourceManager(g.SR),$=Z.getResource.bind(Z),_=function(a){var b=a.row<0?j.BAND_INDEX_CONST:a.row,c=a.col<0?j.BAND_INDEX_CONST:a.col;return h.uf(n,n,b,c,b+a.rowCount-1,c+a.colCount-1)},aa=function(a){var b;if(a instanceof f.Expression)b=a;else if(a instanceof R)b=_(a);else{if(!x(a))throw $().Exp_NotSupport;a=y(a),isNaN(a)||(b=new f.Expression(2),b.value=a)}return b};function cb(a,b,c){var d,e;for(d=0;d<a.length;d++)if(e=a[d],e.contains(b,c))return e}function db(a){return a.rowCount}function eb(a){return a.colCount}ba=function(a,b,c,d){var e=a,f=b,g=function(a,b){var g,h,i=this;return i.hasOwnProperty("_ps")||(i._ps={}),g=i._ps,0===arguments.length?g[e]!==o?d?d.call(i,g[e]):g[e]:f:(g[e]!==a&&(h=g[e]!==o?g[e]:f,g[e]=a,b!==!1&&c&&c.call(i,a,h)),i)};return g.isDefault=function(a){return a===f},g},ca=function(a,b,c){var d=this;return c||(c={}),b||(b=d),l.each(b,function(b,e){var f,g=d[e];F(g)||(f=g.call(d),"formula"===e?(d.getFormulaString?f=d.getFormulaString(a,o,o,!0):d.condition()&&d.condition().getFormulaString&&(f=d.condition().getFormulaString(a,o,o,!0)),f&&(c[e]=f)):"iconCriteria"===e||"icons"===e?c[e]=f:S.Ska(f)?c[e]=S.Daa(f):f&&f.toJSON?c[e]=f.toJSON(a):F(f)||g.isDefault(f)||(c[e]=f))}),c},da=function(a,c,d,e){if(d){var f=this,g;c||(c=f),l.each(c,function(c,h){var i,j,k,m,n,o,p,r,s,t;if(g=d[h],!F(g))if("ranges"===h){for(i=[],j=0;j<g.length;j++)k=g[j],i.push(Q(k.row,k.col,db(k),eb(k)));f.ranges(i,!1)}else if("style"===h)f.style(new M,!1),f.style().fromJSON(g,e);else if("iconCriteria"===h)for(m=g.length,n=0;n<m;n++)o=g[n],f.NV[n]=new Ya(o.isGreaterThanOrEqualTo,o.iconValueType,o.iconValue);else if("icons"===h)for(p=g.length,r=0;r<p;r++)s=g[r],f.CZa[r]={iconSetType:s.iconSetType,iconIndex:s.iconIndex};else"iconSetType"===h?f[h](g,!0):"item1"===h||"item2"===h?(f[h](b.$V(),!1),f[h]().fromJSON(g,a)):"expected"===h?l.getType(g)!==q||5!==d.conType&&13!==d.conType?f[h](g,!1):"/OADate("===g.substr(0,8)?f[h](S.Rka(g),!1):f[h](new Date(g)):"condition"===h?(t=new La,t.fromJSON(g,a),f.condition(t,!1)):l.getType(g)===q&&"/OADate("===g.substr(0,8)?f[h](S.Rka(g),!1):f[h](g,!1)})}};function fb(a,b,c){switch(a){case ga.equalsTo:return b===c;case ga.notEqualsTo:return b!==c;case ga.greaterThan:return b>c;case ga.greaterThanOrEqualsTo:return b>=c;case ga.lessThan:return b<c;case ga.lessThanOrEqualsTo:return b<=c;default:return!1}}ea=e.lUa,l.extend(ea.prototype,{YUa:function(){var a=this,b=a.zTa;b&&!b.ZUa&&(b.ZUa=a.U5.AW.map(function(a){return{rule:a,ranges:a.ranges().slice()}}))},$Ua:function(a){var b=this.U5,c=this.kj;c.suspendPaint(),a&&(b.AW=a.map(function(a){var b=a.rule;return b.ranges(a.ranges),b})),c.resumePaint()},_Ua:function(a,b,c){this.YUa(),this.U5.rI(a,b,c)},aVa:function(a,b){this.YUa(),this.U5.GR(a,b)},bVa:function(a,b,c){this.YUa(),this.U5.tI(a,b,c)},cVa:function(a,b){this.YUa(),this.U5.HR(a,b)},dVa:function(){this.YUa(),this.U5.Nm()},eVa:function(){this.YUa()}}),ea.$n("conditionalFormat",{init:function(){this.U5=new ab(this.kj)},undo:function(a){var b=a.ZUa;b&&this.$Ua(b)}}),fa={init:function(){this.conditionalFormats=this.ITa.U5},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=db(a),e=a.col,f=eb(a),g=a.sheetArea,h=this.ITa;"addRows"===b?h._Ua(c,d):"deleteRows"===b?h.aVa(c,d):"addColumns"===b?h.bVa(e,f):"deleteColumns"===b?h.cVa(e,f):"clear"===b?h.dVa():"setColumnCount"!==b&&"setRowCount"!==b||3!==g&&1!==g||h.eVa()},toJson:function(a,b){var c=this.conditionalFormats,d=b&&b.ignoreStyle;c&&!d&&(a.conditionalFormats=c.toJSON(this))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;a&&a.conditionalFormats&&!d&&this.conditionalFormats.fromJSON(a.conditionalFormats,this,b)}},e.Worksheet.$n("conditionalFormat",fa),e.Workbook.$n("conditionalFormat",{fromJson:function(a,b,c){this.sheets.forEach(function(a){a.conditionalFormats&&a.conditionalFormats.getRules().forEach(function(a){a.S$a()})})}}),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(ga=b.GeneralComparisonOperators||(b.GeneralComparisonOperators={})),function(a){a[a.or=0]="or",a[a.and=1]="and"}(ha=b.LogicalOperators||(b.LogicalOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(ia=b.ComparisonOperators||(b.ComparisonOperators={})),function(a){a[a.contains=0]="contains",a[a.doesNotContain=1]="doesNotContain",a[a.beginsWith=2]="beginsWith",a[a.endsWith=3]="endsWith"}(ja=b.TextComparisonOperators||(b.TextComparisonOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain"}(ka=b.TextCompareType||(b.TextCompareType={})),function(a){a[a.backgroundColor=0]="backgroundColor",a[a.foregroundColor=1]="foregroundColor"}(la=b.ColorCompareType||(b.ColorCompareType={})),function(a){a[a.empty=0]="empty",a[a.nonEmpty=1]="nonEmpty",a[a.error=2]="error",a[a.nonError=3]="nonError",a[a.formula=4]="formula"}(ma=b.CustomValueType||(b.CustomValueType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",a[a.afterEqualsTo=5]="afterEqualsTo"}(na=b.DateCompareType||(b.DateCompareType={})),function(a){a[a.dateOccurring=0]="dateOccurring",a[a.yearOccurring=1]="yearOccurring",a[a.quarterOccurring=2]="quarterOccurring",a[a.monthOccurring=3]="monthOccurring",a[a.weekOccurring=4]="weekOccurring",a[a.dayOccurring=5]="dayOccurring",a[a.yearTodate=6]="yearTodate"}(oa=b.DateExConditionExpectType||(b.DateExConditionExpectType={})),function(a){a[a.top=0]="top",a[a.bottom=1]="bottom"}(pa=b.Top10ConditionType||(b.Top10ConditionType={})),function(a){a[a.today=0]="today",a[a.yesterday=1]="yesterday",a[a.tomorrow=2]="tomorrow",a[a.last7Days=3]="last7Days",a[a.thisMonth=4]="thisMonth",a[a.lastMonth=5]="lastMonth",a[a.nextMonth=6]="nextMonth",a[a.thisWeek=7]="thisWeek",a[a.lastWeek=8]="lastWeek",a[a.nextWeek=9]="nextWeek",a[a.nextQuarter=10]="nextQuarter",a[a.thisQuarter=11]="thisQuarter",a[a.lastQuarter=12]="lastQuarter",a[a.nextYear=13]="nextYear",a[a.thisYear=14]="thisYear",a[a.lastYear=15]="lastYear"}(qa=b.DateOccurringType||(b.DateOccurringType={})),function(a){a[a.quarter1=0]="quarter1",a[a.quarter2=1]="quarter2",a[a.quarter3=2]="quarter3",a[a.quarter4=3]="quarter4"}(ra=b.QuarterType||(b.QuarterType={})),function(a){a[a.above=0]="above",a[a.below=1]="below",a[a.equalOrAbove=2]="equalOrAbove",a[a.equalOrBelow=3]="equalOrBelow",a[a.above1StdDev=4]="above1StdDev",a[a.below1StdDev=5]="below1StdDev",a[a.above2StdDev=6]="above2StdDev",a[a.below2StdDev=7]="below2StdDev",a[a.above3StdDev=8]="above3StdDev",a[a.below3StdDev=9]="below3StdDev"}(sa=b.AverageConditionType||(b.AverageConditionType={})),function(a){a[a.number=0]="number",a[a.lowestValue=1]="lowestValue",a[a.highestValue=2]="highestValue",a[a.percent=3]="percent",a[a.percentile=4]="percentile",a[a.automin=5]="automin",a[a.formula=6]="formula",a[a.automax=7]="automax"}(ta=b.ScaleValueType||(b.ScaleValueType={})),function(a){a[a.leftToRight=0]="leftToRight",a[a.rightToLeft=1]="rightToLeft"}(ua=b.BarDirection||(b.BarDirection={})),function(a){a[a.automatic=0]="automatic",a[a.cellMidPoint=1]="cellMidPoint",a[a.none=2]="none"}(va=b.DataBarAxisPosition||(b.DataBarAxisPosition={})),function(a){a[a.threeArrowsColored=0]="threeArrowsColored",a[a.threeArrowsGray=1]="threeArrowsGray",a[a.threeTriangles=2]="threeTriangles",a[a.threeStars=3]="threeStars",a[a.threeFlags=4]="threeFlags",a[a.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",a[a.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",a[a.threeSigns=7]="threeSigns",a[a.threeSymbolsCircled=8]="threeSymbolsCircled",a[a.threeSymbolsUncircled=9]="threeSymbolsUncircled",a[a.fourArrowsColored=10]="fourArrowsColored",a[a.fourArrowsGray=11]="fourArrowsGray",a[a.fourRedToBlack=12]="fourRedToBlack",a[a.fourRatings=13]="fourRatings",a[a.fourTrafficLights=14]="fourTrafficLights",a[a.fiveArrowsColored=15]="fiveArrowsColored",a[a.fiveArrowsGray=16]="fiveArrowsGray",a[a.fiveRatings=17]="fiveRatings",a[a.fiveQuarters=18]="fiveQuarters",a[a.fiveBoxes=19]="fiveBoxes",a[a.noIcons=20]="noIcons"}(wa=b.IconSetType||(b.IconSetType={})),function(a){a[a.number=1]="number",a[a.percent=4]="percent",a[a.formula=7]="formula",a[a.percentile=5]="percentile"}(xa=b.IconValueType||(b.IconValueType={})),function(a){a[a.relationCondition=0]="relationCondition",a[a.numberCondition=1]="numberCondition",a[a.textCondition=2]="textCondition",a[a.colorCondition=3]="colorCondition",a[a.formulaCondition=4]="formulaCondition",a[a.dateCondition=5]="dateCondition",a[a.dateExCondition=6]="dateExCondition",a[a.textLengthCondition=7]="textLengthCondition",a[a.top10Condition=8]="top10Condition",a[a.uniqueCondition=9]="uniqueCondition",a[a.averageCondition=10]="averageCondition",a[a.cellValueCondition=11]="cellValueCondition",a[a.areaCondition=12]="areaCondition",a[a.timeCondition=13]="timeCondition"}(ya=b.ConditionType||(b.ConditionType={})),function(a){a[a.conditionRuleBase=0]="conditionRuleBase",a[a.cellValueRule=1]="cellValueRule",a[a.specificTextRule=2]="specificTextRule",a[a.formulaRule=3]="formulaRule",a[a.dateOccurringRule=4]="dateOccurringRule",a[a.top10Rule=5]="top10Rule",a[a.uniqueRule=6]="uniqueRule",a[a.duplicateRule=7]="duplicateRule",a[a.averageRule=8]="averageRule",a[a.twoScaleRule=10]="twoScaleRule",a[a.threeScaleRule=11]="threeScaleRule",a[a.dataBarRule=12]="dataBarRule",a[a.iconSetRule=13]="iconSetRule"}(za=b.RuleType||(b.RuleType={})),Aa=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)},Ba=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999)},Ca=function(a,b){a.setDate(b)},Da=function(a){return a.getDate()},Ea=function(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()},Fa=function(a,b){var c=Ba(a);return b>c},Ga=function(a,b){var c=Aa(a);return b<c},Ha=function(a,b){return a.getHours()===b.getHours()&&a.getMinutes()===b.getMinutes()&&a.getSeconds()===b.getSeconds()&&a.getMilliseconds()===b.getMilliseconds()},Ia=function(a,b){var c=new Date(1899,11,30,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),d=new Date(1899,11,30,b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds());return d>c},Ja=function(a,b){return!Ia(a,b)&&!Ha(a,b)},b.$V=function(a,b,c,d,e,f,g,h,i){return new La(a,{compareType:b,expected:c,formula:d,customValueType:e,type:f,ranges:g,item1:h,item2:i})},b.Cxb=new M,Ka=["conType","compareType","item1","item2","ignoreBlank","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],La=function(){function a(a,b){var c,d;b||(b={}),c=b.formula,d=this,d.offsetRow=0,d.offsetCol=0,d.conType("string"==typeof a?ya[a]:a),F(b.compareType)||d.RV(b.compareType),F(b.expected)||d.expected(b.expected),F(c)||d.formula("string"==typeof c?B(l.trim(c),"="):c),F(b.item1)||d.item1(b.item1),F(b.item2)||d.item2(b.item2),F(b.customValueType)||d.customValueType(b.customValueType),F(b.type)||d.type(b.type),d.ranges(b.ranges),d.Lf=n,d.TV=n}return a.prototype.context=function(a){if(1===arguments.length){this.xc=a;var b=this.item1(),c=this.item2();b&&b.context&&b.context(a),c&&c.context&&c.context(a)}return this.xc},a.prototype.j_a=function(a){var b=this,c=b.item1(),d=b.item2();a?b.q$a=!0:b.p$a=!0,c&&c.j_a(a),d&&d.j_a(a)},a.prototype.k_a=function(){var a=this,b=a.item1(),c=a.item2();delete a.q$a,delete a.p$a,b&&b.k_a(),c&&c.k_a()},a.prototype.initExpression=function(a,b,c){var d,e,f,g,h,i=this.item1(),j=this.item2();i&&i.initExpression&&i.initExpression(),j&&j.initExpression&&j.initExpression(),a=a||this.xc,d=this.Yw,a&&d&&!this.Lf&&(this.ranges()?(e=K(this.ranges()),b=e.r,c=e.c):(b=b||0,c=c||0),f=a.getCalcService(),g=a.yj(),f&&g&&(h=!1,this.q$a&&(h=!this.p$a),this.Lf=f.parse(g,d,b,c,!1,!0,h)))},a.prototype.expression=function(a,b,c,d){var e,f,g;return 1===arguments.length?(this.Lf=a,b=b||this.xc,a?b&&(this.ranges()?(e=K(this.ranges()),c=e.r,d=e.c):(c=c||0,d=d||0),f=b.getCalcService(),g=b.yj(),f&&g&&(this.Yw=f.unparse(g,a,c,d))):this.Yw=a,this.Lf):(this.Lf||this.initExpression(b,c,d),this.Lf)},a.prototype.getFormulaString=function(a,b,c,d){var e,f,g;return a=a||this.xc,e=this.Lf,f=this.Yw,a&&f?(e||(this.initExpression(a,b,c),e=this.Lf),g=K(this.ranges()),b=F(b)?g.r:b,c=F(c)?g.c:c,a.getCalcService().unparse(a.yj(),e,b,c,o,!!d)):f},a.prototype.formula=function(a,b,c){if("string"!=typeof a){var d=this.item1(),e=this.item2();return 0===c&&d&&d.formula?d.formula(a,b,c):1===c&&e&&e.formula?e.formula(a,b,c):this.getFormulaString(o,a,b)}this.Yw=a,this.Lf=n},a.prototype.adjustOffset=function(a,b){var c=this,d=c.item1();d&&d.adjustOffset&&d.adjustOffset(a,b),d=c.item2(),d&&d.adjustOffset&&d.adjustOffset(a,b),c.offsetRow=a,c.offsetCol=b},a.prototype.relationConditionEvaluate=function(a,b,c,d,e){var f,g,h,i,j=this;function k(d,e){if(a&&d&&3===d.conType()){var f=a.getActualStyle(b,c,3,!0);f&&(0===d.RV()?e=f.backColor:1===d.RV()&&(e=f.foreColor))}return e}function l(a,b){if(a)return a.ignoreBlank(j.ignoreBlank()),arguments.length<5?k(a,d):b}function m(d,e){return!F(d)&&d.evaluate(a,b,c,e)}return f=l(j.item1(),d),g=l(j.item2(),e),h=m(j.item1(),f)?1:0,i=m(j.item2(),g)?1:0,h+i>j.RV()},a.prototype.cellValueConditionEvaluate=function(a,b,c,d){var e=this.getExpected(a,b,c);return!(e!==n||!a||!a.lRa)||this.cellValueConditionCheckCondition(e,d)},a.prototype.cellValueConditionCheckCondition=function(a,b){var c,d,e,f=this,g=0,h=!1;if(F(b)&&F(a))switch(f.RV()){case ga.equalsTo:case ga.greaterThanOrEqualsTo:case ga.lessThanOrEqualsTo:return!0;case ga.notEqualsTo:case ga.greaterThan:case ga.lessThan:return!1;default:return!1}return"boolean"==typeof a||"boolean"==typeof b?fb(f.RV(),b,a):(c={},F(b)?f.treatNullValueAsZero()?h=!0:g=b:"boolean"!=typeof b&&z(b,c)&&(g=c.value,h=!isNaN(g)),h?(d=0,e=!1,z(a,c)&&(d=c.value,e=!0),e?fb(f.RV(),g,d):f.RV()===ga.notEqualsTo):"string"==typeof b?"string"==typeof a?fb(f.RV(),b,a):1===f.RV():!!F(b)&&f.RV()===ga.notEqualsTo)},a.prototype.numberConditionEvaluate=function(a,b,c,d){var e=this.numberConditionGetExpected(a,b,c);return!(e!==n||!a||!a.lRa)||(this.integerValue()&&(e=isNaN(e)?n:e>0?u(e):v(e)),this.numberConditionCheckCondition(e,d))},a.prototype.numberConditionCheckCondition=function(a,b){var c,d,e=this;if((F(b)||""===b)&&e.ignoreBlank())return!0;if(isNaN(b))return!1;if(F(a)){if(e.ignoreBlank())return!0;a=0}try{c=parseFloat(b)}catch(a){return!1}return!(e.integerValue()&&(d=c-u(c)===0,!d))&&fb(e.RV(),c,a)},a.prototype.numberConditionGetExpected=function(a,b,c){var d,e=this;return e.Yw&&e.Yw.length>0?(d=a.Cf(),d?d.evaluate(a.yj(),e.expression(n,a),b,c):e.expected()):e.expected()},a.prototype.textConditionEvaluate=function(a,b,c,d){var e,f,g,h=this,i=h.compareType(),j=h.ignoreCase();function k(a,b){return h.testTextByCondition(b,a,"^","$",function(){return j?a.toLowerCase()===b.toLowerCase():a===b})}function l(a,b){return h.testTextByCondition(b,a,"^","",function(){return C(b,a,j)})}function m(a,b){return h.testTextByCondition(b,a,"","$",function(){return D(b,a,j)})}function p(a,b){return h.testTextByCondition(b,a,"","",function(){return E(b,a===o||a===n?"":a,j)})}if(!h.forceValue2Text()&&H(d,Date))return i!==ka.beginsWith&&i!==ka.endsWith&&i!==ka.contains&&(i===ka.doesNotBeginWith||i===ka.doesNotEndWith||i===ka.doesNotContain);if(e=F(d)?"":""+d,h.ignoreBlank()&&""===e)return!0;if(f=this.getExpected(a,b,c),g=F(f)?"":""+f,h.hasWildcard(g)&&"number"==typeof d)return i===ka.doesNotBeginWith||i===ka.doesNotContain||i===ka.doesNotEndWith||i===ka.notEqualsTo;switch(i){case ka.equalsTo:return k(g,e);case ka.notEqualsTo:return!k(g,e);case ka.beginsWith:return l(g,e);case ka.doesNotBeginWith:return!l(g,e);case ka.endsWith:return m(g,e);case ka.doesNotEndWith:return!m(g,e);case ka.contains:return p(g,e);case ka.doesNotContain:return!p(g,e);default:return!1}},a.prototype.hasWildcard=function(a){return a.indexOf("*")>-1||a.indexOf("?")>-1},a.prototype.testTextByCondition=function(a,b,c,d,e){var f,g=this.useWildCards();return g?this.regex()?G.qb(this.regex()).test(a):(f=G.ub(b))?(f=c+f+d,this.ignoreCase()?G.sb(f).test(a):G.qb(f).test(a)):e():e()},a.prototype.colorConditionEvaluate=function(a,b,c,d){var e,f,g,h;function i(a){return F(a)||""===a?n:O.ec(a)}if(e=this,f=i(e.expected()),F(f)||""===f){if(e.ignoreBlank()||F(f)&&F(d))return!0}else if(g=i(d),(F(g)||""===g)&&a&&a.getDefaultStyle&&(h=a.getDefaultStyle(),e.RV()===la.backgroundColor?g=h.backColor:e.RV()===la.foregroundColor&&(g=h.foreColor)),!F(g)&&""!==g)return g=g,f=f,g.a===f.a&&g.r===f.r&&g.g===f.g&&g.b===f.b;return!1},a.prototype.formulaConditionEvaluate=function(a,b,c,d){var e,f,g,h;if(!L)return!1;if(e=this,e.customValueType()===ma.formula)return f=e.getExpected(a,b,c),!(!e.ignoreBlank()||!F(f)&&""!==f)||(g={},!!w.Uh(f,g)&&g.value);switch(h=w.vf,e.customValueType()){case ma.empty:return F(d)||""===d;case ma.nonEmpty:return!F(d)&&""!==d;case ma.error:return h(d);case ma.nonError:return!h(d);default:return!1}},a.prototype.formulaConditionGetExpected=function(a,b,c){var d,e,g,i,j,k,l,m,n,p,q=this;if(q.Yw&&q.Yw.length>0){if(d=a.Cf(),!d)return q.expected();if(e=d.Hg(a.yj(),q.expression(o,a),h.pf(b,c),!0),g=void 0,i=void 0,j=void 0,k=void 0,l=void 0,w.Fh(e)){for(g=e.getRowCount(0),i=e.getColumnCount(0),j=[],k=0;k<g;k++)for(j[k]=[],l=0;l<i;l++)j[k][l]=e.getValue(0,k,l);e=j}else if(w.Ca(e)){for(g=e.getRowCount(),i=e.getColumnCount(),j=[],k=0;k<g;k++)for(j[k]=[],l=0;l<i;l++)j[k][l]=e.getValue(k,l);e=j}return H(e,Array)?(g=W(e),i=W(e[0]),1===g&&1===i?e[0][0]:(m=cb(q.ranges(),b,c),n=b-m.row,p=c-m.col,n<g&&p<i?e[n][p]:f.Errors.NotAvailable)):e}return q.expected()},a.prototype.dateOrTimeEvaluate=function(a,b,c,d,e,f,g){var h,i,j=this;if((F(d)||""===d)&&j.ignoreBlank())return!0;if(!H(d,Date))return j.RV()===na.notEqualsTo;if(h=n,i=this.getExpected(a,b,c),H(i,Date)?h=i:"string"==typeof i?h=S.Qa(i):"number"==typeof i&&(h=S.Xb(i)),F(h))return!!j.ignoreBlank();switch(j.RV()){case na.equalsTo:return e(h,d);case na.notEqualsTo:return!e(h,d);case na.after:return g(h,d);case na.afterEqualsTo:return g(h,d)||e(h,d);case na.before:return f(h,d);case na.beforeEqualsTo:return f(h,d)||e(h,d);default:return!1}},a.prototype.dateConditionEvaluate=function(a,b,c,d){return this.dateOrTimeEvaluate(a,b,c,d,Ea,Ga,Fa)},a.prototype.timeConditionEvaluate=function(a,b,c,d){return this.dateOrTimeEvaluate(a,b,c,d,Ha,Ja,Ia)},a.prototype.dateExConditionEvaluate=function(a,b,c,d){var e=this.A4(a,b,c);return!F(e)&&this.dateExConditionCheckCondition(e,d)},a.prototype.getExConditionDateScope=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=n,K=n,L=new Date,M=new Date(L.getFullYear(),L.getMonth(),L.getDate(),L.getHours(),L.getMinutes(),L.getSeconds(),L.getMilliseconds());switch(a){case qa.last7Days:Ca(M,Da(M)-6),J=Aa(M),K=Ba(L);break;case qa.yesterday:Ca(M,Da(M)-1),J=Aa(M),K=Ba(M);break;case qa.today:J=Aa(L),K=Ba(L);break;case qa.tomorrow:Ca(M,Da(M)+1),J=Aa(M),K=Ba(M);break;case qa.lastWeek:b=L,Ca(b,Da(L)-L.getDay()-7),c=M,c.setDate(Da(M)-M.getDay()-1),J=Aa(b),K=Ba(c);break;case qa.thisWeek:d=L,Ca(d,Da(L)-L.getDay()),e=M,Ca(e,Da(M)-M.getDay()+6),J=Aa(d),K=Ba(e);break;case qa.nextWeek:f=L,Ca(f,Da(L)-L.getDay()+7),g=M,Ca(g,Da(M)-M.getDay()+13),J=Aa(f),K=Ba(g);break;case qa.lastMonth:h=L,Ca(h,1),h.setMonth(L.getMonth()-1),i=M,Ca(i,0),J=Aa(h),K=Ba(i);break;case qa.thisMonth:j=L,Ca(j,1),k=M,Ca(k,1),k.setMonth(M.getMonth()+1),Ca(k,0),J=Aa(j),K=Ba(k);break;case qa.nextMonth:l=L,Ca(l,1),l.setMonth(L.getMonth()+1),m=M,Ca(m,1),m.setMonth(M.getMonth()+2),Ca(m,0),J=Aa(l),K=Ba(m);break;case qa.nextQuarter:o=L,p=o.getMonth(),q=p%3,o.setDate(1),o.setMonth(p-q+3),r=M,s=void 0,r.setMonth(p-q+6),s=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(s),J=Aa(o),K=Ba(r);break;case qa.thisQuarter:t=L,u=t.getMonth(),v=u%3,t.setDate(1),t.setMonth(u-v),w=M,x=void 0,w.setMonth(u-v+3),x=2===w.getMonth()||11===w.getMonth()?31:30,w.setDate(x),J=Aa(t),K=Ba(w);break;case qa.lastQuarter:y=L,z=y.getMonth(),A=z%3,y.setDate(1),y.setMonth(z-A-3),B=M,C=void 0,B.setMonth(z-A),C=2===B.getMonth()||11===B.getMonth()?31:30,B.setDate(C),J=Aa(y),K=Ba(B);break;case qa.nextYear:D=L,D.setDate(1),D.setFullYear(D.getFullYear()+1),D.setMonth(0),E=M,E.setFullYear(E.getFullYear()+1),E.setMonth(11),E.setDate(31),J=Aa(D),K=Ba(E);break;case qa.thisYear:F=L,F.setDate(1),F.setMonth(0),G=M,G.setMonth(11),G.setDate(31),J=Aa(F),K=Ba(G);break;case qa.lastYear:H=L,H.setFullYear(H.getFullYear()-1),H.setDate(1),H.setMonth(0),I=M,I.setFullYear(I.getFullYear()-1),I.setMonth(11),I.setDate(31),J=Aa(H),K=Ba(I)}return{from:J,to:K}},a.prototype.dateExConditionCheckCondition=function(a,c){var d,e,f,g,h,i,j,k,l,m,o,p;function q(a,b){switch(a){case ra.quarter1:return b.getMonth()>=0&&b.getMonth()<=2;case ra.quarter2:return b.getMonth()>=3&&b.getMonth()<=5;case ra.quarter3:return b.getMonth()>=6&&b.getMonth()<=8;case ra.quarter4:return b.getMonth()>=9&&b.getMonth()<=11;default:return!1}}if(d=this,e=c,d.ignoreBlank()&&(F(e)||""===e))return!0;try{e=w.Wh(e)}catch(a){return!1}if(g=d.expectTypeId(),g===oa.dateOccurring){if(h=this.getExConditionDateScope(a),i=h.from,j=h.to,!F(i)&&!F(j))return k=b.$V(ya.dateCondition,na.afterEqualsTo,i,n),l=b.$V(ya.dateCondition,na.beforeEqualsTo,j,n),m=b.$V(ya.relationCondition,ha.and,n,n,n,n,n,k,l),m.evaluate(n,0,0,e)}else if(f=d.A4(n,0,0),!F(f)){if(g===oa.yearOccurring)return f===e.getFullYear();if(g===oa.quarterOccurring)return q(f,e);if(g===oa.monthOccurring)return f===e.getMonth();if(g===oa.weekOccurring)return f===e.getDay();if(g===oa.dayOccurring)return f===Da(e);if(g===oa.yearTodate)return o=new Date,p=new Date,o.setMonth(0,1),o.setHours(0,0,0,0),p.setHours(23,59,59,59),o<=e&&e<=p}return!1},a.prototype.textLengthConditionEvaluate=function(a,b,c,d){var e,f;return F(d)||""===d?this.ignoreBlank():(e=F(d)?0:(""+d).length,f=this.A4(a,b,c),"number"==typeof f&&fb(this.RV(),e,f))},a.prototype.top10ConditionEvaluate=function(a,b,c,d){var e,f,g,h=this;if(F(d)||""===d)return h.ignoreBlank();if(e=h.A4(a,b,c),!F(e)&&(f=void 0,h.k$a?(F(h.mxb)&&(h.mxb=h.getTopValues(a,e,h.ranges())),f=h.mxb):f=h.getTopValues(a,e,h.ranges()),f)){g=0;try{g=h.Pa(d)}catch(a){return!1}if(T.Bb(f,g))return!0}return!1},a.prototype.A4=function(a,b,c){var d=this.getExpected(a,b,c);return d=parseInt(d,10),isNaN(d)||!isFinite(d)?n:d},a.prototype.adjustRange=function(a,b){return Q(a.row,a.col,Math.min(db(a),b.getRowCount()),Math.min(eb(a),b.getColumnCount()))},a.prototype.getTopValues=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=0===this.type()?1:-1,n=[];if(!c)return n;for(d=this.UV(a,c),e=W(d),j=0;j<e;j++)for(f=this.adjustRange(d[j],a),k=0;k<db(f);k++)for(g=k+f.row,l=0;l<eb(f);l++)h=l+f.col,i=this.Pa(a.getValue(g,h)),F(i)||n.push(i);return n.sort(function(a,b){return(b-a)*m}),W(n)>b&&(n=n.slice(0,b)),n},a.prototype.Pa=function(a){return("number"==typeof a||H(a,Date))&&L?y(a):n},a.prototype.uniqueConditionEvaluate=function(a,b,c,d){var e,f,g,h,i=this,j=d;return F(j)||""===j?i.ignoreBlank():(L&&x(j)&&(j=y(j)),e=this.getExpected(a,b,c),f={},w.Uh(e,f),g=f.value,!F(g)&&(h=i.duplicatedArrayCached||i.getDuplicated(a,i.ranges()),!F(h)&&T.Bb(h,j)?g===!0:g!==!0))},a.prototype.getDuplicated=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=[],o={},p=this.UV(a,b);if(p)for(c=W(p),d=0;d<c;d++)for(e=p[d],e=this.adjustRange(e,a),f=db(e),g=eb(e),h=0;h<f;h++)for(i=h+e.row,j=0;j<g;j++)k=j+e.col,l=a.getValue(i,k,3),!F(l)&&L&&x(l)&&(l=y(l)),m=o[l],m?1===m&&n.push(l):o[l]=1;return n},a.prototype.VV=function(a,b){var c,d=a.length;for(c=0;c<d;c++)if(a[c].key===b)return!0;return!1},a.prototype.averageConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l;if(!L)return!1;if(e=this,e.ignoreBlank()&&(F(d)||""===d))return!0;if(e.WV(),e.k$a?(F(e.mxb)&&(e.mxb=e.getExpected(a,b,c)),f=e.mxb):f=e.getExpected(a,b,c),g={},h=z(f,g)?g.value:NaN,i=n,j=e.TV?e.XV(a,e.TV,b,c):n,F(j)||(g={},i=z(j,g)?g.value:NaN),x(d)&&(k=y(d),!isNaN(h)))switch(l=isNaN(i),e.type()){case sa.above:return k>h;case sa.below:return k<h;case sa.equalOrAbove:return k>=h;case sa.equalOrBelow:return k<=h;case sa.above1StdDev:return!l&&k>h+i;case sa.below1StdDev:return!l&&k<h-i;case sa.above2StdDev:return!l&&k>h+2*i;case sa.below2StdDev:return!l&&k<h-2*i;case sa.above3StdDev:return!l&&k>h+3*i;case sa.below3StdDev:return!l&&k<h-3*i;default:return!1}return!1},a.prototype.WV=function(){var a=this;a.ranges()&&(a.Lf=a.YV("AVERAGE",a.ranges()),a.type()>=4&&a.type()<=9&&(a.TV=a.YV("STDEV",a.ranges())))},a.prototype.YV=function(a,b){var c,d,e,g;if(!L)return n;if(c=X.findGlobalFunction(a)){for(d=[],e=W(b),g=0;g<e;g++)d[g]=aa(b[g]);return f.Jh(c,d)}return n},a.prototype.averageConditionGetExpected=function(a,b,c){var d=a.Cf();return d?d.Hg(a.yj(),this.expression(o,a),h.pf(b,c),!1):n},a.prototype.nxb=function(){var a=this.conType();a!==ya.averageCondition&&a!==ya.top10Condition||(this.k$a=!0)},a.prototype.oxb=function(){var a=this;a.k$a=!1,a.mxb=o},a.prototype.XV=function(a,b,c,d){var e=a.Cf();return e?e.Hg(a.yj(),b,h.pf(c,d),!1):n},a.prototype.ZV=function(a,b){var c,d;for(d=0;d<W(b);d++)c=b[d],H(c,Array)&&W(c)>0?W(b)>1?a.push(c[0]):a.push.apply(a,c):a.push(c)},a.prototype.getValidList=function(a,b,c){var d,e,f=[],g=this.getValidListImp(a,b,c);for(d=0,e=W(g);d<e;d++)f.push(g[d].value);return f},a.prototype.getValidListImp=function(a,b,c){var d,e,f,g,h,i,j,k,m=this,n=[];if(m.Yw&&m.Yw.length>0)d=m.getExpected(a,b,c),H(d,Array)?m.ZV(n,d):n.push(d);else if(m.expected()&&m.expected().length>0&&(e=m.expected(),f=e.replace(/\\,/g,String.fromCharCode(206)),g=f.split(",")))for(h=0;h<W(g);h++)i=g[h],F(i)||(j=RegExp(String.fromCharCode(206),"g"),k=l.trim(i).replace(j,","),""!==k&&n.push({text:k,value:k}));return n},a.prototype.areaConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j;function k(a,b){return H(a,Date)&&H(b,Date)?a.valueOf()===b.valueOf():a===b}if(e=this,F(d)||""===d)return e.ignoreBlank()===!0;for(f=e.getValidList(a,b,c),g=0;g<W(f);g++){if(h=f[g],F(h)&&F(d))return!0;if(e.Yw){if(k(h,d))return!0}else if(i=a.getActualStyle(b,c,3,!0),j=I.ul(i,h,!0),k(j,d))return!0}return!1},a.prototype.areaConditionGetExpected=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,p,q=this,r=[];if(q.Yw){if(d=void 0,e=void 0,f=void 0,g=void 0,i=void 0,j=void 0,k=a.Cf(),!k)return r;if(l=k.Hg(a.yj(),q.expression(o,a),h.pf(b,c),!0),w.Fh(l))for(d=l.getRowCount(0),e=l.getColumnCount(0),m=l.getRow(0),n=l.getColumn(0),p=l.xf&&l.xf.kj,f=0;f<d;f++)for(r[f]=[],g=0;g<e;g++)i=l.getValue(0,f,g),j=p?p.getText(m+f,n+g):i,r[f][g]={value:i,text:j};else if(w.Ca(l))for(d=l.getRowCount(),e=l.getColumnCount(),f=0;f<d;f++)for(r[f]=[],g=0;g<e;g++)i=l.getValue(f,g),r[f][g]={value:i,text:i}}else r.push({value:q.expected(),text:q.expected()});return r},a.prototype.reset=function(){var a=this;switch(a.ignoreBlank(!1),a.RV(1),a.item1(n),a.item2(n),a.value1=n,a.value2=n,a.expected(n),a.RV(0),a.integerValue(!1),a.operator=0,a.text="",a.RV(0),a.useWildCards(!0),a.ignoreCase(!1),a.forceValue2Text(!1),a.customValueType(0),a.Lf=n,a.type(0),this.expectTypeId(0),a.ranges(n),a.isPercent(!1),a.regex(n),a.conType()){case ya.relationCondition:a.ignoreBlank(!1),a.RV(1);break;case ya.numberCondition:a.RV(0),a.integerValue(!1);break;case ya.textCondition:a.RV(0),a.useWildCards(!0),a.forceValue2Text(!1);break;case ya.colorCondition:a.RV(0);break;case ya.formulaCondition:a.customValueType(0),a.TV=n;break;case ya.dateCondition:case ya.timeCondition:a.RV(0);break;case ya.dateExCondition:a.expectTypeId(0);break;case ya.textLengthCondition:a.RV(0);break;case ya.top10Condition:a.type(0);break;case ya.averageCondition:a.type(0);break;case ya.cellValueCondition:a.operator=6;break;case ya.areaCondition:}},a.prototype.evaluate=function(a,b,c,d){var e=this.conType();return!F(e)&&this[ya[e]+"Evaluate"](a,b,c,d)},a.prototype.getExpectedNormal=function(a,b,c,d,e,f){var g,i=this,j=i.Yw,k=i.expected();return j?(g=a.Cf(),g?g.Hg(a.yj(),i.expression(o,a),h.pf(b,c),!1,f):k):k},a.prototype.getExpected=function(a,b,c){var d=this;switch(d.conType()){case 2:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 8:return d.getExpectedNormal(a,b,c,b,c);case 0:return n;case 1:return d.numberConditionGetExpected(a,b,c);case 3:return n;case 4:return d.formulaConditionGetExpected(a,b,c);case 10:return d.averageConditionGetExpected(a,b,c);case 12:return d.areaConditionGetExpected(a,b,c);default:return n}},a.prototype.UV=function(a,b){var c,d,e,f=[];for(c=0,d=W(b);c<d;c++)e=a.Tq(b[c]),f.push(e);return f},a.prototype.getExpressions=function(){var a=[],b=this;return 0===b.conType()?(b.item1()&&b.item1().getExpressions&&(a=b.item1().getExpressions()),
b.item2()&&b.item2().getExpressions&&(a=a.concat(b.item2().getExpressions())),a):(b.Lf||b.initExpression(),b.Lf?[b.Lf]:[])},a.prototype.setExpressions=function(a,b){var c=this,d;return b&&b.push({type:"condition",condition:this,expressions:c.getExpressions()}),0===c.conType()?(c.item1()&&c.item1().setExpressions&&(d=c.item1().getExpressions().length,c.item1().setExpressions(a.slice(0,d))),void(c.item2()&&c.item2().setExpressions&&c.item2().setExpressions(a.slice(d)))):void c.expression(a[0])},a.prototype.toJSON=function(a){return ca.call(this,a,Ka)},a.prototype.fromJSON=function(a,b,c){if(a){var d=this;da.call(d,b,Ka,a,c),d.j_a(!0),d.initExpression(),d.k_a()}},a.fromSource=function(a){return b.$V(12,n,a,n)},a.fromFormula=function(a){return b.$V(12,n,"",a)},a.fromDay=function(a){var c=b.$V(6,n,a);return c.expectTypeId(5),c},a.fromMonth=function(a){var c=b.$V(6,n,a);return c.expectTypeId(3),c},a.fromQuarter=function(a){var c=b.$V(6,n,a);return c.expectTypeId(2),c},a.fromWeek=function(a){var c=b.$V(6,n,a);return c.expectTypeId(4),c},a.fromYear=function(a){var c=b.$V(6,n,a);return c.expectTypeId(1),c},a}(),b.Condition=La,La.prototype.conType=ba("conType",n),La.prototype.ranges=ba("ranges",n,function(a){var b=this.item1(),c=this.item2();b&&b.ranges&&b.ranges(a),c&&c.ranges&&c.ranges(a)}),La.prototype.ignoreBlank=ba("ignoreBlank",!1),La.prototype.compareType=ba("compareType",o),La.prototype.RV=La.prototype.compareType,La.prototype.expected=ba("expected",o),La.prototype.item1=ba("item1",n),La.prototype.item2=ba("item2",n),La.prototype.treatNullValueAsZero=ba("treatNullValueAsZero",!1),La.prototype.integerValue=ba("integerValue",!1),La.prototype.forceValue2Text=ba("forceValue2Text",!1),La.prototype.useWildCards=ba("useWildCards",!0),La.prototype.regex=ba("regex",n),La.prototype.ignoreCase=ba("ignoreCase",!1),La.prototype.customValueType=ba("customValueType",o),La.prototype.expectTypeId=ba("expectTypeId",0),La.prototype.type=ba("type",n),La.prototype.isPercent=ba("isPercent",!1);function gb(a,b,c,d,e,f,g,h,i){var j=Math.round;switch(a.lineWidth=1,a.rect(f,g,h,i),c++,c=j(c),d=j(d),a.clip(),b.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:k.drawArrows(a,b.iconSetType,b.iconIndex,c,d,e);break;case 2:k.drawIconTypeIsTwo(a,b.iconSetType,b.iconIndex,c,d,e);break;case 3:k.drawStar(a,b.iconSetType,b.iconIndex,c,d,e);break;case 14:case 12:case 5:k.drawCircle(a,b.iconSetType,b.iconIndex,c,d,e);break;case 4:k.drawFlag(a,b.iconSetType,b.iconIndex,c,d,e);break;case 6:k.drawTrafficLight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 7:k.drawIconTypeIsSen(a,b.iconSetType,b.iconIndex,c,d,e);break;case 8:k.drawIconTypeIsEight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 9:k.drawIconTypeIsNine(a,b.iconSetType,b.iconIndex,c,d,e);break;case 18:k.drawSector(a,b.iconSetType,b.iconIndex,c,d,e);break;case 17:case 13:k.drawSignal(a,b.iconSetType,b.iconIndex,c,d,e);break;case 19:k.drawMagicCube(a,b.iconSetType,b.iconIndex,c,d,e)}}Ma=function(){function a(a,b,c){var d=this;d.xyb=!0,d.ruleType(a),d.style(b),d.ranges(c)}return a.prototype.stopIfTrue=function(a){},a.prototype.evaluate=function(a,c,d,e){var f,g,h=this;return h.contains(c,d)?(h.initCondition(),f={baseRow:0,baseCol:0},h.getBaseCoordinate(f),h.condition().adjustOffset(c-f.baseRow,d-f.baseCol),g=n,h.condition().evaluate(a,c,d,e)&&(g=h.getExpected()||b.Cxb),h.condition().adjustOffset(0,0),g):n},a.prototype.contains=function(a,b){var c,d,e,f=this.ranges();if(f)for(c=W(f),d=void 0,e=0;e<c;e++)if(d=f[e],d.contains(a,b))return!0;return!1},a.prototype.createCondition=function(){return this.xyb=!1,null},a.prototype.initCondition=function(a){var b=this.condition();b||(b=this.createCondition(),b&&(b.ranges(this.ranges()),this.condition(b)),a&&this.context(a),this.context()&&b&&b.context(this.context()))},a.prototype.yyb=function(){var a,b=this;b.xyb&&(a=b.condition(),a||(b.initCondition(),a=b.condition()),a&&!a.Lf&&a.initExpression())},a.prototype.context=function(a){return 1===arguments.length&&(this.xc=a,this.condition()&&this.condition().context(a)),this.xc},a.prototype.getExpected=function(){return this.style()},a.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.stopIfTrue(!1),a.priority(1)},a.prototype.intersects=function(a,b,c,d){var e,f,g,h=this.ranges();if(h)for(e=W(h),f=void 0,g=0;g<e;g++)if(f=h[g],f.intersect(a,b,c,d))return!0;return!1},a.prototype.isScaleRule=function(){return!1},a.prototype.getBaseCoordinate=function(a){var b,c,d,e,f;if(a.baseRow=Number.MAX_VALUE,a.baseCol=Number.MAX_VALUE,b=this,b.ranges()&&W(b.ranges())>0)for(c=0;c<W(b.ranges());c++)d=b.ranges()[c],e=d.row,f=d.col,e=e===-1?0:e,f=f===-1?0:f,a.baseRow=r(e,a.baseRow),a.baseCol=r(f,a.baseCol);else a.baseRow=0,a.baseCol=0},a.prototype._V=function(a,b,c,d){var e,f,g,h,i,j=this,k=c?b:0,l=c?0:b;if(j.yyb(),j.ranges())for(e=W(j.ranges()),f=0;f<e;f++)if(g=j.ranges()[f],h=c?g.row:g.col,i=c?db(g):eb(g),h!==-1){if(d&&(!c&&d.col===g.col&&d.col+d.colCount===g.col+g.colCount&&d.col===a||c&&d.row+1===g.row&&d.row+d.rowCount===g.row+g.rowCount&&g.row===a))return void(j.ranges()[f]=Q(g.row,g.col,db(g)+k,eb(g)+l));h>=a?j.ranges()[f]=Q(g.row+k,g.col+l,db(g),eb(g)):a<=h+i&&(j.ranges()[f]=Q(g.row,g.col,db(g)+k,eb(g)+l))}},a.prototype.rI=function(a,b,c){this._V(a,b,!0,c)},a.prototype.tI=function(a,b,c){this._V(a,b,!1,c)},a.prototype.aW=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=c?a:0,p=c?0:a,q=c?b:0,s=c?0:b;if(n.yyb(),n.ranges()){for(d=[],e=W(n.ranges()),f=0;f<e;f++)g=n.ranges()[f],h=c?g.row:g.col,i=c?db(g):eb(g),h!==-1&&(h>a?h+i<=a+b?d.push(g):n.ranges()[f]=Q(g.row-q,g.col-s,db(g),eb(g)):a<h+i&&(j=Q(g.row,g.col,db(g)-r(g.row+db(g)-o,q),eb(g)-r(g.col+eb(g)-p,s)),0===eb(j)||0===db(j)?d.push(g):n.ranges()[f]=j));for(k=W(d),l=0;l<k;l++)m=d[l],U(n.ranges(),m)}},a.prototype.GR=function(a,b){this.aW(a,b,!0)},a.prototype.HR=function(a,b){this.aW(a,b,!1)},a.prototype.toJSON=function(a){return ca.call(this,a)},a.prototype.fromJSON=function(a,b,c){a&&(da.call(this,b,n,a,c),this.initCondition(b))},a.prototype.S$a=function(){var a=this.condition();a&&J(a)},a.prototype.hW=function(a){var b,c,d=[],e=W(a);for(c=0;c<e;c++)b=a[c],d.push(Q(b.row,b.col,db(b),eb(b)));return d},a.prototype.iW=function(){var a,b,c,d=this.cW,e=this.ranges();if(!d)return this.cW=this.hW(e),!1;if(a=W(d),b=W(e),a!==b)return!0;for(c=0;c<b;c++)if(!d[c].equals(e[c]))return!0;return!1},a}(),b.ConditionRuleBase=Ma,Na=Ma.prototype,Na.ruleType=ba("ruleType",n),Na.ranges=ba("ranges",n,function(a){var b,c=this.condition();c&&c.ranges()&&(b=c.xc,b&&b.ITa.YUa(),c.ranges(a))}),Na.condition=ba("condition",n),Na.style=ba("style",n),Na.priority=ba("priority",1),Na.stopIfTrue=ba("stopIfTrue",!1);function hb(a,b){return a===za.cellValueRule&&(b===ia.between||b===ia.notBetween)}Oa=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Pa=function(a){bb(c,a);function c(b,c,d,e,f,g,h,i,j,k){var m=a.call(this,b,d)||this,o=m;return o.ranges(c),o.operator(e),o.value1("string"==typeof f?l.trim(f):f),o.value2("string"==typeof g?l.trim(g):g),o.text(h),o.formula(i),o.type(j),o.rank(k),o.cached=!1,o.cW=n,m}return c.prototype.value1=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,0),d&&d.length>0)?"="+B(l.trim(""+d),"="):this._Qa):void(this._Qa=a)},c.prototype.value2=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,1),d&&d.length>0)?"="+B(l.trim(""+d),"="):this.aRa):void(this.aRa=a)},c.prototype.formula=function(a,b){var c=this,d=c.condition();return"string"!=typeof a?d&&d.formula(a,b)||c.Yw:(c.Yw=a,void(d&&d.formula(a)))},c.prototype.cellValueRuleCreateCondition=function(){var a,c,d,e,f,g,h,i,j=this,k=j.value1(),l=j.value2(),m=j.ranges(),p=j.bW(k)?B(k,"="):n,q=j.bW(l)?B(l,"="):n,r=j.operator();return r===ia.between?(a=b.$V(ya.cellValueCondition,3,k,p,o,o,m),a.treatNullValueAsZero(!0),c=b.$V(ya.cellValueCondition,5,l,q,o,o,m),c.treatNullValueAsZero(!0),f=b.$V(ya.relationCondition,1,n,n,n,n,m,a,c),d=b.$V(ya.cellValueCondition,5,k,p,o,o,m),d.treatNullValueAsZero(!0),e=b.$V(ya.cellValueCondition,3,l,q,o,o,m),e.treatNullValueAsZero(!0),g=b.$V(ya.relationCondition,1,n,n,n,n,m,d,e),b.$V(ya.relationCondition,0,n,n,n,n,m,f,g)):r===ia.notBetween?(a=b.$V(ya.cellValueCondition,4,k,p,o,o,m),a.treatNullValueAsZero(!0),c=b.$V(ya.cellValueCondition,2,l,q,o,o,m),a.treatNullValueAsZero(!0),f=b.$V(ya.relationCondition,0,n,n,n,n,m,a,c),d=b.$V(ya.cellValueCondition,2,k,p,o,o,m),d.treatNullValueAsZero(!0),e=b.$V(ya.cellValueCondition,4,l,q,o,o,m),e.treatNullValueAsZero(!0),g=b.$V(ya.relationCondition,0,n,n,n,n,m,d,e),b.$V(ya.relationCondition,1,n,n,n,n,m,f,g)):(h=r,i=b.$V(11,h,k,p,o,o,m),i.treatNullValueAsZero(!0),i)},c.prototype.bW=function(a){return!F(a)&&"="===a[0]},c.prototype.specificTextRuleCreateCondition=function(){var a,c,d,e,f=this.operator();switch(f){case 2:a=2;break;case 3:a=4;break;case 0:a=6;break;case 1:a=7;break;default:a=0}return c=this.text(),d=n,c&&"="===c[0]&&(d=c),e=b.$V(2,a,c,d,o,o,this.ranges()),e.ignoreCase(!0),e.useWildCards(2!==f&&3!==f),e},c.prototype.formulaRuleCreateCondition=function(){var a=this,c=a.ranges();return b.$V(4,n,n,a.Yw,4,n,c)},c.prototype.dateOccurringRuleCreateCondition=function(){return b.$V(6,n,this.type(),n,n,o,this.ranges())},c.prototype.top10RuleCreateCondition=function(){return b.$V(8,n,this.rank(),n,n,this.type(),this.ranges())},c.prototype.uniqueRuleCreateCondition=function(){return b.$V(9,n,!1,n,n,n,this.ranges())},c.prototype.duplicateRuleCreateCondition=function(){return b.$V(9,n,!0,n,n,n,this.ranges())},c.prototype.averageRuleCreateCondition=function(){return b.$V(10,n,n,n,n,this.type(),this.ranges())},c.prototype.createCondition=function(){return this[za[this.ruleType()]+"CreateCondition"]()},c.prototype.reset=function(){var a=this;switch(a.ranges(n),a.condition(n),a.style(n),a.stopIfTrue(!1),a.priority(1),a.operator(6),a.value1(n),a.value2(n),a.text(""),a.formula(n),a.type(0),a.rank(10),a.ruleType()){case 1:a.operator(6);break;case 2:a.operator(0);break;case 4:a.style(n);break;case 5:a.type(0),a.rank(10);break;case 8:a.type(0)}},c.prototype.evaluate=function(b,c,d,e){return this.jW(b),a.prototype.evaluate.call(this,b,c,d,e)},c.prototype.jW=function(a){var b,c=this;c.initCondition(),b=c.condition(),9===b.conType()&&(c.iW()&&(c.Nm(),c.cW=c.hW(c.ranges())),c.cached===!1&&(b.duplicatedArrayCached=b.getDuplicated(a,c.ranges()),c.cached=!0))},c.prototype.Nm=function(){this.cached=!1},c.prototype.rI=function(b,c,d){a.prototype.rI.call(this,b,c,d),this.Nm()},c.prototype.tI=function(b,c,d){a.prototype.tI.call(this,b,c,d),this.Nm()},c.prototype.GR=function(b,c){a.prototype.GR.call(this,b,c),this.Nm()},c.prototype.HR=function(b,c){a.prototype.HR.call(this,b,c),this.Nm()},c.prototype.toJSON=function(a){var b,c,d,e,f,g=this;return F(g.condition())&&this.initCondition(),b=ca.call(g,a,Oa),c=g.value1(),hb(b.ruleType,b.operator)&&(d=g.value2()),e=a&&a.parent&&1===a.parent.options.referenceStyle,F(c)||(g.bW(c)&&e&&(c=ib(a,g,c,e)),b.value1=c),F(d)||(g.bW(d)&&e&&(d=ib(a,g,d,e)),b.value2=d),f=g.ruleType(),f===za.conditionRuleBase&&(b.condition=g.condition().toJSON()),b},c.prototype.fromJSON=function(a,b,c){var d=Oa;F(a.condition)||(d=Oa.concat(["condition"])),da.call(this,b,d,a,c),F(a.value1)||this.value1(a.value1),F(a.value2)||this.value2(a.value2),this.initCondition(b)},c}(Ma),b.NormalConditionRule=Pa;function ib(a,b,c,d){var e=b.ranges(),f=K(e),g=j.formulaToExpression(a,c,f.r,f.c,d);return j.expressionToFormula(a,g,f.r,f.c,!d)}Qa={operator:ba("operator",n),text:ba("text",n),type:ba("type",n),rank:ba("rank",n),priority:ba("priority",1)},l.extend(Pa.prototype,Qa),Ra=function(){function a(a,b){this.type=a,this.value=b}return a}(),b.ScaleValue=Ra,Sa=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],Ta=function(a){bb(c,a);function c(b,c,d,e,f,g,h,i,j,k,l){var m,o,p,q,r,s,t,u,v,w=a.call(this,b,n,l)||this,x=w;return x.xyb=!1,x.lowestValueCached=n,x.highestValueCached=n,x.zyb={},x.cached=!1,x.cW=n,m=c,o=d,p=e,q=f,r=g,s=h,t=i,u=j,v=k,arguments.length<=1&&(m=1,o=n,p=P(255,248,105,107),q=4,r=50,s=P(255,255,235,132),t=2,u=n,v=P(255,99,190,123)),x.minColor(p),x.minValue(o),x.minType(m),x.midColor(s),x.midValue(r),x.midType(q),x.maxColor(v),x.maxValue(u),x.maxType(t),w}return c.prototype.stopIfTrue=function(a){return!1},c.prototype.isScaleRule=function(){return!0},c.prototype.createCondition=function(){return n},c.prototype.fW=function(a){var c=b.$V(8,n,n,n,n,1).getTopValues(a,1,this.ranges());return W(c)>0?c[0]:n},c.prototype.gW=function(a){var c=b.$V(8,n,n,n,n,0).getTopValues(a,1,this.ranges());return W(c)>0?c[0]:n},c.prototype.jW=function(a){var b=this;b.iW()&&(b.Nm(),b.cW=b.hW(b.ranges())),b.cached===!1&&(b.lowestValueCached=b.fW(a),b.highestValueCached=b.gW(a),b.cached=!0)},c.prototype.Nm=function(){this.lowestValueCached=n,this.highestValueCached=n,this.zyb={},this.cached=!1},c.prototype.kW=function(a,b,c,d){var e,f;return d&&(e=a.Cf())?(f=e.parse(a.yj(),d,b,c),e.Hg(a.yj(),f,h.pf(b,c),!1)):n},c.prototype.bW=function(a){return a&&"="===a[0]},c.prototype.lW=function(a){return F(a)||""===a?n:"="===a[0]?a.substr(1):a},c.prototype.mW=function(a,b,c,d){if(this.bW(d))return this.kW(a,b,c,this.lW(""+d));var e={};return z(d,e)?e.value:NaN},c.prototype.dW=function(a){return this.jW(a),this.highestValueCached},c.prototype.eW=function(a){return this.jW(a),this.lowestValueCached},c.prototype.nW=function(a,b,c,d){var e,f,g=this.mW(a,b,c,d);return!isNaN(g)&&0<=g&&g<=100&&(e=this.eW(a),f=this.dW(a),typeof e!==p&&e!==n&&typeof f!==p&&f!==n)?e+(f-e)*g/100:n},c.prototype.oW=function(a,b,c,d){var e,f,g,i,j,k,l,m,o,p,q,r,s=this.zyb;if(void 0!==s[d])return s[d];if(e=this.mW(a,b,c,d),!isNaN(e)&&0<=e&&e<=100){for(f=0,g=this.ranges(),i=W(g),j=0;j<i;j++)k=this.YV("PERCENTILE",[a.Tq(g[j]),e/100]),l=a.Cf(),m=a.yj(),o=l.unparse(m,k,b,c),p=l.parse(m,o,b,c),q=l.Hg(m,p,h.pf(b,c),!1),r={},f+=z(q,r)?r.value:0;return s[d]=f/i,s[d]}return s[d]=n,s[d]},c.prototype.pW=function(a,b,c,d,e){var f,g,h=this;switch(d){case ta.formula:return h.bW(e)||(e="="+e),h.mW(a,b,c,e);case ta.highestValue:return h.dW(a);case ta.lowestValue:return h.eW(a);case ta.number:return h.mW(a,b,c,e);case ta.percent:return h.nW(a,b,c,e);case ta.percentile:return h.oW(a,b,c,e);case ta.automax:return f=h.dW(a),f<0?0:f;case ta.automin:return g=h.eW(a),g>0?0:g;default:return n}},c.prototype.qW=function(a,b,c){return a===b&&a===c?1:a<=b?0:a>=c?1:(a-b)/(c-b)},c.prototype.rW=function(a,b,c){var d,e,f,g,h,i;return 0<=a&&a<=1?(d=O.ec(b),e=O.ec(c),f=d.a*(1-a)+e.a*a,g=d.r*(1-a)+e.r*a,h=d.g*(1-a)+e.g*a,i=d.b*(1-a)+e.b*a,P(parseFloat(f/255+""),parseInt(g+"",10),parseInt(h+"",10),parseInt(i+"",10))):n},c.prototype.YV=function(a,b){var c,d,e,g;if(!L)return n;if(c=X.findGlobalFunction(a)){for(d=[],e=W(b),g=0;g<e;g++)d[g]=aa(b[g]);return f.Jh(c,d)}return n},c.prototype.rI=function(b,c,d){a.prototype.rI.call(this,b,c,d),this.Nm()},c.prototype.tI=function(b,c,d){a.prototype.tI.call(this,b,c,d),this.Nm()},c.prototype.GR=function(b,c){a.prototype.GR.call(this,b,c),this.Nm()},c.prototype.HR=function(b,c){a.prototype.HR.call(this,b,c),this.Nm()},c.prototype.scaleEvaluate=function(a,b,c,d){var e,f,g,h,i=this;if(i.jW(a),i.contains(b,c)){if(F(d))return n;try{if(e=y(d),f=i.pW(a,b,c,i.minType(),i.minValue()),g=i.pW(a,b,c,i.midType(),i.midValue()),h=i.pW(a,b,c,i.maxType(),i.maxValue()),f>h)return n;if(isNaN(g)){if(!isNaN(f)&&!isNaN(h))return i.qW(e,f,h)}else if(!isNaN(f)&&!isNaN(h))return e<f?0:e>=h?2:f<=e&&e<=g?i.qW(e,f,g):1+i.qW(e,f,h)}catch(a){return n}}return n},c.prototype.twoScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j;if(!F(d)){if(e={},f=x(d)&&z(d,e)?e.value:NaN,isNaN(f))return n;if(g=this,h=g.pW(a,b,c,g.minType(),g.minValue()),i=g.pW(a,b,c,g.maxType(),g.maxValue()),!F(h)&&!F(i))return j=g.qW(f,h,i),g.rW(j,g.minColor(),g.maxColor())}return n},c.prototype.threeScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k=this;if(k.lh=a,!F(d)){if(e={},f=x(d)&&z(d,e)?e.value:NaN,isNaN(f))return n;if(g=k.pW(a,b,c,k.minType(),k.minValue()),h=k.pW(a,b,c,k.midType(),k.midValue()),i=k.pW(a,b,c,k.maxType(),k.maxValue()),!F(g)&&!F(i)&&!F(h))return j=void 0,g>i?n:f<=g||g===i?f>=i?k.maxColor():k.minColor():f>=i?k.maxColor():f<=h?(j=k.qW(f,g,h),k.rW(j,k.minColor(),k.midColor())):(j=k.qW(f,h,i),k.rW(j,k.midColor(),k.maxColor()))}return n},c.prototype.evaluate=function(a,b,c,d){return this[za[this.ruleType()]+"Evaluate"](a,b,c,d)},c.prototype.ad=function(){var a=this;a.minValue(n),a.minType(1),a.midValue(50),a.midType(4),a.maxValue(n),a.maxType(2),10===a.ruleType()&&(a.minColor(P(0,255,255,255)),a.maxColor(P(255,99,190,123))),11===a.ruleType()&&(a.midValue(50),a.midType(4),a.minColor(P(255,248,105,107)),a.midColor(P(255,255,235,132)),a.maxColor(P(255,99,190,123)))},c.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.ad(),a.lh=n,a.stopIfTrue(!1),a.priority(1)},c.prototype.toJSON=function(a){return ca.call(this,a,Sa)},c.prototype.fromJSON=function(a,b,c){da.call(this,b,Sa,a,c),this.initCondition(b)},c}(Ma),b.ScaleRule=Ta,Ua={minValue:ba("minValue",n),minType:ba("minType",5),minColor:ba("minColor",n),midValue:ba("midValue",50,n,function(a){var b=this;if(b.lh){if(2===b.midType())return b.dW(b.lh);if(1===b.midType())return b.eW(b.lh)}return a}),midType:ba("midType",n),midColor:ba("midColor",n),maxType:ba("maxType",7),maxValue:ba("maxValue",n),maxColor:ba("maxColor",n)},l.extend(Ta.prototype,Ua),Va=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],Wa=function(a){bb(b,a);function b(b,c,d,e,f,g){var h=this,i=b,j=c,k=d,l=e,m=f;return 0===arguments.length&&(i=5,j=n,k=7,l=n,m=P(255,99,142,198)),h=a.call(this,12,i,j,n,n,n,n,k,l,n,g)||this,h.xyb=!1,h.ad(m),h}return b.prototype.ad=function(a){var b=this;b.gradient(!0),b.color(a),b.showBorder(!1),b.borderColor("black"),b.dataBarDirection(0),b.negativeFillColor("red"),b.useNegativeFillColor(!0),b.negativeBorderColor("black"),b.useNegativeBorderColor(!1),b.axisPosition(0),b.axisColor("black"),b.showBarOnly(!1)},b.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.ad(P(255,99,142,198)),a.stopIfTrue(!1),a.priority(1),a.minValue(n),a.minType(5),a.midValue(n),a.midType(n),a.maxValue(n),a.maxType(7),a.minColor(n),a.midColor(n),a.maxColor(n)},b.prototype.sW=function(a,b,c,d){var e,f,g,h,i=this,j=d?i.maxType():i.minType(),k=d?i.maxValue():i.minValue();if(6!==j&&4!==j)return i.pW(a,b,c,j,k);for(f=0;f<W(i.ranges());f++)if(i.ranges()[f].intersect(b,-1,1,-1)&&(e=i.ranges()[f]))return g=e.row,h=e.col,g=g===-1?0:g,h=h===-1?0:h,i.pW(a,g,h,j,k)},b.prototype.tW=function(a,b,c){var d=0;return a>=c&&a>b?[1,d]:a<=b&&a<c?[0,d]:c===b?[.5,d]:[(a-b)/(c-b),d]},b.prototype.uW=function(a,b,c){var d,e,f=.5,g=t(c-b);return c>0&&b>=0?c===b?[.5,f]:a>=c?[.5,f]:a<=b?[b/c*.5,f]:[.5*t(a/c),f]:c>0&&b<0?(d=c>t(b)?.5:c/g,e=c>t(b)?b/g:-.5,a>0?a>=c?[d,f]:[a/c*d,f]:a<0?a<=b?[e,f]:[a/b*e,f]:[0,f]):c<=0&&b<0?c===b?[-.5,f]:a>=c?[-c/b*.5,f]:a<=b?[-.5,f]:[-a/b*.5,f]:0===c&&0===b?[0,f]:(f=-1,[-1,f])},b.prototype.vW=function(a,b,c){var d,e,f,g=-1,h=t(b),i=t(c),j=t(c-b),k=b<0?-1:1;return c>0&&b>=0||c<=0&&b<0?(d=s(h,i),e=r(h,i),f=t(a),g=b<0?1:0,f<=e&&f<d?[0,g]:f>=d&&f>e?[k,g]:e===d?[.5*k,g]:[k*(t(a)-e)/j,g]):c>0&&b<0?(g=t(b)/j,0===a?[0,g]:a>=c?[1-g,g]:[s(a,b)/j,g]):0===c&&0===b?(g=.5,0===a?[0,g]:[.5*k,g]):[-1,g]},b.prototype.wW=function(a,b,c){var d=this;return 0===d.axisPosition()?d.vW(a,b,c):1===d.axisPosition()?d.uW(a,b,c):d.tW(a,b,c)},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o,p,q;if(!F(d)){if(e={},f=x(d,!0)&&z(d,e)?e.value:NaN,isNaN(f))return n;if(g=this,h=g.sW(a,b,c,!1),i=g.sW(a,b,c,!0),H(h,Date)&&(h=S.Ra(h)),H(i,Date)&&(i=S.Ra(i)),!F(h)&&!F(i))return h>i&&(j=i,i=h,h=j),k=void 0,l=g.wW(f,h,i),!l||W(l)<2?n:(m=l[0],k=l[1],o=f<0&&g.useNegativeFillColor()?g.negativeFillColor():g.color(),p=f<0&&g.useNegativeBorderColor()?g.negativeBorderColor():g.borderColor(),q=g.axisColor(),o=Y.Om(a,o),p=Y.Om(a,p),q=Y.Om(a,q),{fillColor:o,borderColor:p,showBorder:g.showBorder(),axisColor:q,isGradient:g.gradient(),direction:g.dataBarDirection(),axisLocation:k,scale:m,showBarOnly:g.showBarOnly()})}return n},b.prototype.toJSON=function(a){return ca.call(this,a,Va)},b.prototype.fromJSON=function(a,b,c){da.call(this,b,Va,a,c),this.initCondition(b)},b.paintDataBar=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,v,w,x=new e.Rect(c+2,d+2,f-4,g-4),y=x.x,z=x.y,A=u(t(x.width*b.scale)),B=x.height;if(0===b.axisLocation)b.scale<=0&&(A=0);else if(1===b.axisLocation)b.scale<0?y=y+x.width-A:A=0;else{for(h=u(x.width*b.axisLocation+y)+.5,i=x.y,j=1,k=g-2,a.lineWidth=j,a.strokeStyle=b.axisColor,a.beginPath(),l=0;l<=k;l+=2)1===b.direction?(a.moveTo(2*c+f-h,i+l),a.lineTo(2*c+f-h,i+l+1)):(a.moveTo(h,i+l),a.lineTo(h,i+l+1));a.stroke(),b.scale>0?y=h+j:b.scale<0?y=h-A:A=0}b.showBorder&&(y=u(y)+.5,A-=1,z+=.5,B-=1),m=y,n=y+A,1===b.direction&&(m=2*c+f-y-A,n=2*c+f-y),A>=0&&B>=0&&(o=b.fillColor,b.isGradient&&(p=.9,o=a.createLinearGradient(m,z,n,z),q=O.ec(b.fillColor),r=P(q.a,u(255*p+q.r*(1-p)),u(255*p+q.g*(1-p)),u(255*p+q.b*(1-p))),s=b.scale<0?1-p:p,v=b.fillColor,w=b.scale<0?1:0,1===b.direction?(o.addColorStop(s,v),o.addColorStop(w,r)):(o.addColorStop(s,r),o.addColorStop(w,v))),a.fillStyle=o,a.fillRect(m,z,A,B),b.showBorder&&A>0&&B>0&&(a.strokeStyle=b.borderColor,a.strokeRect(m,z,A,B)))},b}(Ta),b.DataBarRule=Wa,Xa={gradient:ba("gradient",!0),color:ba("color",n),showBorder:ba("showBorder",!1),borderColor:ba("borderColor","black"),dataBarDirection:ba("dataBarDirection",0),negativeFillColor:ba("negativeFillColor","red"),useNegativeFillColor:ba("useNegativeFillColor",!0),negativeBorderColor:ba("negativeBorderColor","black"),useNegativeBorderColor:ba("useNegativeBorderColor",!1),axisPosition:ba("axisPosition",0),axisColor:ba("axisColor","black"),showBarOnly:ba("showBarOnly",!1)},l.extend(Wa.prototype,Xa),Ya=function(){function a(a,b,c){this.isGreaterThanOrEqualTo=a,this.iconValueType=b,this.iconValue=c}return a}(),b.IconCriterion=Ya,Za=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],$a=function(a){bb(b,a);function b(b,c){var d=this,e=b;return 0===arguments.length&&(e=0),d=a.call(this,13,n,n,n)||this,d.xyb=!1,d.ranges(c),d.ad(e),d}return b.prototype.xW=function(a){var b=this;b.iconSetType(a,!1),b.iconSetType()>=wa.threeArrowsColored&&b.iconSetType()<=wa.threeSymbolsUncircled?(b.NV=[],b.NV[0]=new Ya((!0),xa.percent,33),b.NV[1]=new Ya((!0),xa.percent,67),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2}):b.iconSetType()>=wa.fourArrowsColored&&b.iconSetType()<=wa.fourTrafficLights?(b.NV=[],b.NV[0]=new Ya((!0),xa.percent,25),b.NV[1]=new Ya((!0),xa.percent,50),b.NV[2]=new Ya((!0),xa.percent,75),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3}):b.iconSetType()>=wa.fiveArrowsColored&&b.iconSetType()<=wa.fiveBoxes?(b.NV=[],b.NV[0]=new Ya((!0),xa.percent,20),b.NV[1]=new Ya((!0),xa.percent,40),b.NV[2]=new Ya((!0),xa.percent,60),b.NV[3]=new Ya((!0),xa.percent,80),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3},b.CZa[4]={iconSetType:a,iconIndex:4}):b.iconSetType()>wa.fiveBoxes&&(b.NV=[],b.CZa=[])},b.prototype.ad=function(a){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(a)},b.prototype.yW=function(a){var b=W(this.NV)+1;return this.reverseIconOrder()&&b>2?b-1-a:a},b.prototype.pW=function(a,b,c,d){var e=this,f=e.NV[d];if(f)switch(f.iconValueType){case xa.formula:return e.mW(a,b,c,f.iconValue);case xa.number:return e.mW(a,b,c,f.iconValue);case xa.percent:return e.nW(a,b,c,f.iconValue);case xa.percentile:return e.oW(a,b,c,f.iconValue);default:return n}},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o,p,q,r=this,s=d;if(F(s))return n;if(e={},f=x(d,!0)&&"boolean"!=typeof s&&z(d,e)?e.value:NaN,isNaN(f))return n;if(g=0,h=r.iconSetType(),i=r.NV,h>=wa.fiveArrowsColored?g=5:h>=wa.fourArrowsColored?g=4:h>=wa.threeArrowsColored&&(g=3),!i)return 0;for(k=0,l=g-1;l>0;l--)if(l<W(i)+1&&(j=i[l-1],!F(j&&j.iconValue)&&(m=r.pW(a,b,c,l-1),!F(m)&&(o=j.isGreaterThanOrEqualTo?f>=m:f>m,f<Number.MAX_VALUE&&o)))){k=l;break}return p=r.yW(k),q=r.CZa,q?{iconSetType:q[p]?q[p].iconSetType:wa.noIcons,iconIndex:q[p]?q[p].iconIndex:0,showIconOnly:r.showIconOnly()}:{iconSetType:wa.noIcons,iconIndex:0,showIconOnly:r.showIconOnly()}},b.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.showIconOnly(!1),a.reverseIconOrder(!1),a.iconSetType(0,n),a.NV=n,a.stopIfTrue(!1),a.priority(1),a.minColor(n),a.minValue(n),a.minType(5),a.midColor(n),a.midValue(n),a.midType(n),a.maxColor(n),a.maxValue(n),a.maxType(7),a.CZa=n},b.prototype.icons=function(a){return 1===arguments.length&&(this.CZa=a),this.CZa},b.prototype.iconCriteria=function(){return this.NV},b.prototype.toJSON=function(a){return ca.call(this,a,Za)},b.prototype.fromJSON=function(a,b,c){da.call(this,b,Za,a,c),this.initCondition(b)},b.paintIconSet=function(a,b,c,d,e,f,g,h,j){var k,l=i.To.No(g.font,1).fontSize,m=l,n=2,o=2,p=c+n;b.showIconOnly&&(1===g.hAlign?p=c+e/2-m/2:2===g.hAlign&&(p=c+e-n-m-2)),k=1===g.vAlign?d+f/2-m/2:2===g.vAlign?d+f-o-h/2-m/2:d+o+h/2-m/2,b.iconSetType!==wa.noIcons&&gb(a,b,p,k,m,c,d,e,f)},b}(Ta),b.IconSetRule=$a,_a={iconSetType:ba("iconSetType",wa.threeArrowsColored,function(a){this.xW(a)}),reverseIconOrder:ba("reverseIconOrder",!1),showIconOnly:ba("showIconOnly",!1)},l.extend($a.prototype,_a);function jb(a){return"string"==typeof a&&(a=l.trim(a),"="!==a[0]&&(a='="'+m.Gb(a,'"','""')+'"')),a}ab=function(){function a(a){this.AW=[],this.BW=n,this.WS=a}return a.prototype.getRule=function(a){return this.AW[a]},a.prototype.count=function(){return W(this.AW)},a.prototype.w4=function(){return this.AW},a.prototype.UV=function(a){var b,c,d=[],e=this.WS,f=W(a);for(b=0;b<f;b++)c=e.Tq(a[b]),d.push(c);return d},a.prototype.EW=function(a){var b,c,d,e,f=[],g=this.WS;for(b=0,c=W(a);b<c;b++)d=a[b],e=new R(d.row,d.col,db(d),eb(d)),0===d.row&&db(d)===g.getRowCount()&&(e.row=-1),0===d.col&&eb(d)===g.getColumnCount()&&(e.col=-1),f.push(e);return f},a.prototype.Ayb=function(a,b){var c,d,e=[];for(c=0;c<W(this.AW);c++)d=this.AW[c],d.contains(a,b)&&e.push(d);return e},a.prototype.addSpecificTextRule=function(a,b,c,d){var e=new Pa(2,d,c,a,n,n,b);return this.addRule(e)},a.prototype.addCellValueRule=function(a,b,c,d,e){var f=new Pa(1,e,d,a,jb(b),jb(c));return this.addRule(f)},a.prototype.addDateOccurringRule=function(a,b,c){var d=new Pa(4,c,b,n,n,n,n,n,a);return this.addRule(d)},a.prototype.addFormulaRule=function(a,b,c){var d=new Pa(3,c,b,n,n,n,n,a);return this.addRule(d)},a.prototype.addTop10Rule=function(a,b,c,d){var e=new Pa(5,d,c,n,n,n,n,n,a,b);return this.addRule(e)},a.prototype.addUniqueRule=function(a,b){var c=new Pa(6,b,a);return this.addRule(c)},a.prototype.addDuplicateRule=function(a,b){var c=new Pa(7,b,a);return this.addRule(c)},a.prototype.addAverageRule=function(a,b,c){var d=new Pa(8,c,b,n,n,n,n,n,a);return this.addRule(d)},a.prototype.add3ScaleRule=function(a,b,c,d,e,f,g,h,i,j){var k;return k=0===arguments.length?new Ta(11):new Ta(11,a,b,c,d,e,f,g,h,i,j),this.addRule(k)},a.prototype.add2ScaleRule=function(a,b,c,d,e,f,g){var h;return h=0===arguments.length?new Ta(10):new Ta(10,a,b,c,n,n,n,d,e,f,g),this.addRule(h)},a.prototype.addDataBarRule=function(a,b,c,d,e,f){var g;return g=0===arguments.length?new Wa:new Wa(a,b,c,d,e,f),this.addRule(g)},a.prototype.addIconSetRule=function(a,b){var c=new $a(a,b);return this.addRule(c)},a.prototype.addRule=function(a){var b,c,d,e,f=this,g=f.WS;if(g){if(!a)throw Error($().Exp_RuleIsNull);for(g.ITa.YUa(),b=0,c=W(f.AW);b<c;b++)d=f.AW[b]._ps,e=d.priority||1,d.priority=e+1;return a.priority(1),f.AW.push(a),a.context(g),g.$p(),a}},a.prototype.removeRule=function(a){var b=this,c=b.WS;c&&(a&&(c.ITa.YUa(),U(b.AW,a)),c.$p())},a.prototype.IW=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,t,u;return a.intersect(b,c,d,e)?(f=a.row,g=a.row+db(a)-1,h=a.col,i=a.col+eb(a)-1,j=b,k=b+d-1,l=c,m=c+e-1,o=[],f!==-1&&h!==-1&&j!==-1&&l!==-1&&(l-h>0&&(p=Q(f,h,db(a),l-h),o.push(p)),i-m>0&&(q=Q(f,m+1,db(a),i-m),o.push(q)),j-f>0&&(t=Q(f,s(l,h),j-f,r(m,i)-s(l,h)+1),o.push(t)),g-k>0&&(u=Q(k+1,s(l,h),g-k,r(m,i)-s(l,h)+1),o.push(u))),W(o)>0?o:n):[a]},a.prototype.removeRuleByRange=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.WS;if(q){if(e=[],p.AW)for(q.ITa.YUa(),f=0,g=W(p.AW);f<g;f++)if(h=p.AW[f],h&&h.ranges()&&h.intersects(a,b,c,d)){for(i=[],j=p.UV(h.ranges()),k=0,l=W(j);k<l;k++)m=p.IW(j[k],a,b,c,d),m&&(i=i.concat(m));W(i)>0?h.ranges(p.EW(i)):e.push(h)}for(n=0,o=W(e);n<o;n++)U(p.AW,e[n]);q.$p()}},a.prototype.clearRule=function(){var a=this,b=a.WS;b&&(b.ITa.YUa(),a.AW.length=0,b.$p())},a.prototype.getRules=function(a,b){var c,d,e,f,g,h=this,i=h.AW;if(0===arguments.length||0===W(i))return i;if(a=a===o?-1:a,b=b===o?-1:b,c=h.WS,d=c.getRowCount(),e=c.getColumnCount(),f=[],a!==-1&&b!==-1)kb(f,h.Ayb(a,b));else if(a===-1)for(g=0;g<d;g++)kb(f,h.Ayb(g,b));else for(g=0;g<e;g++)kb(f,h.Ayb(a,g));return f},a.prototype.containsRule=function(a,b,c){return!(!a||!T.Bb(this.AW,a))&&a.contains(b,c)},a.prototype._V=function(a,b,c,d){var e,f,g,h=this;if(h.AW&&h.WS)for(e=W(h.AW),f=0;f<e;f++)g=h.AW[f],g&&(c?g.rI(a,b,d):g.tI(a,b,d))},a.prototype.rI=function(a,b,c){this._V(a,b,!0,c)},a.prototype.tI=function(a,b,c){this._V(a,b,!1,c)},a.prototype.aW=function(a,b,c){var d,e,f,g=this;if(g.AW&&g.WS)for(d=W(g.AW),e=d-1;e>=0;e--)f=g.AW[e],f&&(c?f.GR(a,b):f.HR(a,b),f.ranges().length<=0&&g.AW.splice(e,1))},a.prototype.GR=function(a,b){this.aW(a,b,!0)},a.prototype.HR=function(a,b){this.aW(a,b,!1)},a.prototype.Nm=function(){var a,b,c,d=this.AW;if(d!==n&&W(d)>0)for(b=0,c=W(d);b<c;b++)a=d[b],a.Nm&&a.Nm()},a.prototype.XA=function(a,b,c,d,e,f,g,h){var i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=[],L=[],M=[],N=[],O=this,P=O.WS;for(a===-1&&(a=0,d=0,f=P.getRowCount()),b===-1&&(b=0,e=0,g=P.getColumnCount()),i=0;i<f;i++)for(k=0;k<g;k++)for(l=O.getRules(a+i,b+k),m=0;m<W(l);m++){for(n=l[m],o=n.ranges(),p=[],q=0;q<W(o);q++)r=o[q],s=P.Tq(r),t=s.row,u=s.col,v=db(s),w=eb(s),V(M,r)<=-1&&r.contains(a+i,b+k)&&(M.push(r),x=Q(d+i,e+k,-1,-1),t+v>=f+a?x.rowCount=f-i:a<t?x.rowCount=v:x.rowCount=t+v-a,u+w>=g+b?x.colCount=g-k:b<u?x.colCount=w:x.colCount=u+w-b,O===c&&r.containsRange(x)||p.push(x),h&&N.indexOf(x)===-1&&N.push(x));p.length>0&&(y=J.indexOf(n),y<0?(J.push(n),L.push(p)):L[y]=L[y].concat(p))}for(z=0,A=J.length;z<A;z++)B=O.iga(J[z].toJSON(),J[z].context()),C=B.ranges(),B.ranges(L[z]),D=B.Yw,D&&(E=1===P.parent.options.referenceStyle,F=K(C),G=j.formulaToExpression(P,D,F.r,F.c,E),H=K(L[z]),I=j.expressionToFormula(P,G,H.r,H.c,E),B.formula(I)),c.addRule(B);return N},a.prototype.YA=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,t,u,v,w,x=[],y=this,z=y.WS,A=z.getRowCount(3),B=z.getColumnCount(3);for(a===-1&&(a=0,c=z.getRowCount()),b===-1&&(b=0,d=z.getColumnCount()),g=0;g<c;g++)for(h=0;h<d;h++)for(i=y.getRules(a+g,b+h),j=0;j<W(i);j++){for(k=i[j],l=k.ranges(),m=[],n=0;n<W(l);n++)o=l[n],p=z.Tq(o),q=p.row,t=p.col,u=db(p),v=eb(p),N.Bb(e,o)||V(x,o)<=-1&&o.contains(a+g,b+h)&&(x.push(o),a>q&&m.push(Q(q,t,a-q,v)),b>t&&m.push(Q(s(a,q),t,r(a+c,q+u)-s(a,q),b-t)),b+d<t+v&&m.push(Q(s(a,q),b+d,r(a+c,q+u)-s(a,q),t+v-(b+d))),a+c<q+u&&m.push(Q(a+c,t,q+u-(a+c),v)));y.Byb(z,x,e,l,A,B,f),w=l.concat(m),w.length>0?(k.yyb(),k.ranges(w)):y.removeRule(k)}},a.prototype.Byb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m;for(h=0;h<W(b);h++){if(i=b[h],j=[i],g)for(k=0;k<W(c);k++)l=c[k],i.intersect(l.row,l.col,l.rowCount,l.colCount)&&(j=j.concat(a.v_a(i,l,e,f)));for(m=0;m<W(j);m++)U(d,j[m]);
}},a.prototype.jp=function(a,b,c,d,e,f,g,h){var i=16,j=!1,k=!1,l=h.sheet,m=h.row,n=h.col,o=l.zoom(),p=this.oRa(l,m,n,b),q=p.iconSet,r=p.dataBar;return(r||q)&&(a.save(),a.beginPath(),r&&(Wa.paintDataBar(a,r,c,d,e,f),j=r.showBarOnly),q&&(i=parseInt(i*o+"",10),(e<i||f<i)&&(a.rect(c,d,e,f),a.clip(),a.beginPath()),$a.paintIconSet(a,q,c,d,e,f,g,h.lineHeight,o),k=q.showIconOnly),a.restore()),j||k},a.prototype.oRa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o=this,p=a.ss,q=p.Um(b,c);if(q)e=q.i,f=q.d;else{if(g=o.getRules(b,c),h=W(g),h>0){for(g.sort(function(a,b){return a.priority()-b.priority()}),i=n,j=n,k=void 0,l=void 0,m=void 0,m=0;m<h&&(!i||!j);m++)k=g[m],k&&(H(k,Wa)&&(i=k),H(k,$a)&&(j=k));if(i||j)for(i=j=n,m=0;m<h&&(!i||!j)&&(k=g[m],!(k&&(!i&&H(k,Wa)&&(i=k),!j&&H(k,$a)&&(j=k),k.stopIfTrue()&&(l=k.evaluate(a,b,c,d)))));m++);i&&(f=i.evaluate(a,b,c,d)),j&&(e=j.evaluate(a,b,c,d))}p.Wm(b,c,f,e)}return{dataBar:f,iconSet:e}},a.prototype.bp=function(a,b,c){var d,e,f;if(F(c)||3===c)for(d=this.getRules(a,b),e=0,f=W(d);e<f;e++)if(d[e]instanceof $a)return!0;return!1},a.prototype.toJSON=function(a){var b,c,d=[];for(b=0;b<W(this.AW);b++)c=this.AW[b],d.push(c?c.toJSON(a):n);return 0===W(d)?o:{rules:d}},a.prototype.fromJSON=function(a,b,c){var d,e,f;if(a&&a.rules)for(this.AW=[],d=0;d<W(a.rules);d++)e=a.rules[d],f=this.iga(e,b,c),f&&this.AW.push(f)},a.prototype.iga=function(a,b,c){var d,e,f=n;return a&&(d=this.JW(),e=d[a.ruleType],e&&(f=new e,f.fromJSON(a,b,c))),f},a.prototype.JW=function(){if(!this.BW){var a={};a[0]=Pa,a[1]=Pa,a[2]=Pa,a[3]=Pa,a[4]=Pa,a[5]=Pa,a[6]=Pa,a[7]=Pa,a[8]=Pa,a[9]=Ta,a[10]=Ta,a[11]=Ta,a[12]=Wa,a[13]=$a,this.BW=a}return this.BW},a.prototype.Eq=function(a,b,c,d){var e,f,g,h,i,j,k=this;if(k&&k.count()>0&&(e=k.getRules(b,c),f=W(e),g=void 0,h=n,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),i=0;i<f&&(g=e[i],!(g&&(j=k.WS,g.isScaleRule()?10!==g.ruleType()&&11!==g.ruleType()||(h=g.evaluate(j,b,c,j.getValue(b,c,d)),h&&(a||(a=new M),a.backColor===o&&(a.backColor=h))):(h=g.evaluate(j,b,c,j.getValue(b,c,d)),h&&(a||(a=new M),a.Yo(h,!1,1))),g.stopIfTrue()&&h)));i++);return a},a.prototype.Fq=function(a,b,c,d){var e,f,g,h,i,j,k,l,m={v5:!1},p=this;if(p&&p.count()>0&&(e=p.getRules(a,b),f=W(e),g=void 0,h=n,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),i=0;i<f;i++)if(g=e[i]){if(j=p.WS,g.isScaleRule()){if(k=g.ruleType(),"backColor"===c&&(10===k||11===k)&&(h=g.evaluate(j,a,b,j.getValue(a,b,d)))){m.Fi=h,m.v5=!0;break}}else{if(l=g.style(),!(l&&void 0!==l[c]||g.stopIfTrue()))continue;if(h=g.evaluate(j,a,b,j.getValue(a,b,d)),h&&h[c]!==o){m.Fi=h[c],m.v5=!0;break}}if(g.stopIfTrue()&&h)break}return m},a}(),b.ConditionalFormats=ab;function kb(a,b){if(b)for(var c=0;c<b.length;c++)a.push(b[c])}},"./dist/plugins/conditional/conditional.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/conditional/conditional.res.en.js");b.SR={en:d}},"./dist/plugins/conditional/conditional.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RuleIsNull="The argument 'rule' is null",b.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;Object.defineProperty(b,"__esModule",{value:!0}),d=Math.PI,e=Math.round,f=Math.cos,g=Math.sin,h="#4d82b8 #4d82b8 #4d82b8 #4d82b8",i="#326f5b",j="#76a797",k="#A4802b",l="#EAC282",m="#9E381C",n="#D86344",o="#646262",p="#808080",q="#353535",r="#303030",s="#505050",t="#727272",u=[[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d}],[{strokeStyle:k,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:r,fillColor:s,fillColor2:"#d86344",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:"#eac282",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:j,rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"white",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"white",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"white",rotate:d*-.25}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d*-.25}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:p,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:1*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}]];function v(a,b,c,d,e){a.beginPath(),a.moveTo(b,c),a.lineTo(b+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.lineTo(b,c),a.closePath(),a.fill(),a.stroke()}function w(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),i=e(.2*g),a.fillStyle=h[0],v(a,i+.5,3*i+.5,i,2*i),a.fillStyle=h[1],v(a,2*i+.5,2*i+.5,i,3*i),a.fillStyle=h[2],v(a,3*i+.5,i+.5,i,4*i),a.fillStyle=h[3],v(a,4*i+.5,.5,i,5*i)}b.drawSignal=w;function x(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),a.fillStyle=u[b][c].strokeStyle,i=e(g/2),a.fillStyle=h[0],v(a,.5,.5,i,i),a.fillStyle=h[1],v(a,i+.5,.5,i,i),a.fillStyle=h[2],v(a,.5,i+.5,i,i),a.fillStyle=h[3],v(a,i+.5,i+.5,i,i)}b.drawMagicCube=x;function y(a,b,c,e,f,g){a.translate(e+g/2,f+g/2),a.strokeStyle=u[b][c].strokeStyle,4===c?(a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.stroke()):0===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.stroke()):1===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,0),a.lineTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):2===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,.5*d),a.moveTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):3===c&&(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,d),a.moveTo(0,0),a.lineTo(-g/2,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke())}b.drawSector=y;function z(a,b,c){a.moveTo(f(.1*d)*b,-g(.1*d)*b),a.lineTo(f(.3*d)*c,-g(.3*d)*c),a.lineTo(0*b,-g(.5*d)*b),a.lineTo(f(.7*d)*c,-g(.7*d)*c),a.lineTo(f(.9*d)*b,-g(.9*d)*b),a.lineTo(f(1.1*d)*c,-g(1.1*d)*c),a.lineTo(f(1.3*d)*b,-g(1.3*d)*b),a.lineTo(0*c,-g(1.5*d)*c),a.lineTo(f(1.7*d)*b,-g(1.7*d)*b),a.lineTo(f(1.9*d)*c,-g(1.9*d)*c),a.lineTo(f(.1*d)*b,-g(.1*d)*b)}function A(a,b,c,e,h,i){var j=i,k=j/1.8,l=k/2.5;a.translate(k+e,k+h),a.strokeStyle="#727272",a.fillStyle=u[b][c].fillColor,a.beginPath(),2===c&&(a.strokeStyle="#727272",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle=u[b][c].strokeStyle,z(a,k,l),a.stroke(),a.closePath()),0===c&&(a.fillStyle="white",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath()),1===c&&(a.strokeStyle=u[b][c].fillColor,a.moveTo(0*k,-g(.5*d)*k),a.lineTo(f(.7*d)*l,-g(.7*d)*l),a.lineTo(f(.9*d)*k,-g(.9*d)*k),a.lineTo(f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fill(),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(0*k,-g(.5*d)*k),a.lineTo(-f(.7*d)*l,-g(.7*d)*l),a.lineTo(-f(.9*d)*k,-g(.9*d)*k),a.lineTo(-f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(-f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fillStyle="white",a.fill(),a.closePath(),a.beginPath(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath())}b.drawStar=A;function B(a,b,c,d,e,f){2===c?E(a,b,c,d,e,f):0===c?C(a,b,c,d,e,f):1===c&&D(a,b,c,d,e,f)}b.drawIconTypeIsEight=B;function C(a,b,c,f,g,h){var i=h,j=e(i/2);a.translate(f+j,g+j),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.stroke(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.375*-i,.1*-i,.75*i,.2*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.1*-i,.375*-i,.2*i,.75*i),a.closePath(),a.fill(),a.stroke()}function D(a,b,c,e,f,g){var h=g;a.translate(e,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(h/3,.1*h),a.lineTo(h/1.5,.1*h),a.lineTo(.625*h,.6*h),a.lineTo(.375*h,.6*h),a.lineTo(h/3,.1*h),a.moveTo(.625*h,.85*h),a.arc(.5*h,.8*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.closePath()}function E(a,b,c,f,g,h){var i=h;a.translate(e(f+i/2),e(i/2+g)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.25*-i,.2*i,.5*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.05*i,.65*i,.2*i),a.closePath(),a.fill(),a.stroke()}function F(a,b,c,d,e,f){2===c?I(a,b,c,d,e,f):0===c?H(a,b,c,d,e,f):1===c&&G(a,b,c,d,e,f)}b.drawIconTypeIsNine=F;function G(a,b,c,e,f,g){var h=g;a.translate(e,f),a.beginPath(),a.strokeStyle=u[b][c].strokeStyle,a.moveTo(h/3,.5),a.lineTo(h/1.5,.5),a.lineTo(.625*h,.65*h),a.lineTo(.375*h,.65*h),a.lineTo(h/3,.5),a.moveTo(.65*h,.85*h),a.arc(.5*h,.85*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function H(a,b,c,d,f,g){var h,i,j=g;a.translate(e(d+j/2),e(f+j/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),h=.5*j,i=.075*j,V(a,-h,-i),U(a,-h,i),U(a,-i,i),U(a,-i,h),U(a,i,h),U(a,i,i),U(a,h,i),U(a,h,-i),U(a,i,-i),U(a,i,-h),U(a,-i,-h),U(a,-i,-i),U(a,-h,-i),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function I(a,b,c,d,f,g){var h=g;a.translate(e(d+h/2),e(f+h/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.25*-h,.2*h,.5*h),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.05*h,.75*h,.2*h),a.closePath(),a.fill(),a.stroke()}function J(a,b,c,d,f,g){var h=1.2*g;a.translate(d,f),a.strokeStyle=p,a.fillStyle=p,v(a,e(.2*h)+.5,.5,e(.06*h),e(.8*h)),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,.4*h,.5),U(a,.4*h,.5*h),U(a,.9*h,.25*h),U(a,.4*h,.5),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}b.drawFlag=J;function K(a,b,c,d,e,f){2===c?M(a,b,c,d,e,f):1===c?P(a,b,c,d,e,f):O(a,b,c,d,e,f)}b.drawIconTypeIsSen=K;function L(a,b,c,f,g,h){var i=e(h);a.strokeStyle=u[b][c].strokeStyle,a.fillStyle=u[b][c].fillColor,v(a,f+.5,g+.5,i,i),a.beginPath(),a.arc(i/2+f+.5,i/2+g+.5,.375*i,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.stroke()}b.drawTrafficLight=L;function M(a,b,c,e,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(h/2+e,h/2+f,h/2,0,2*d),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}b.drawCircle=M;function N(a,b,c,d,e,f){1===c?Q(a,b,c,d,e,f):0===c?R(a,b,c,d,e,f):2===c&&S(a,b,c,d,e,f)}b.drawIconTypeIsTwo=N;function O(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.translate(d+e(h/2),f+e(h/2)),a.beginPath(),V(a,0,-h/2),U(a,h/2,0),U(a,0,h/2),U(a,-h/2,0),U(a,0,-h/2),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function P(a,b,c,d,f,g){var h=e(g);a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,0,h),U(a,h/2,h-h/2*Math.sqrt(3)),U(a,h,h),U(a,0,h),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function Q(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),a.rotate(u[b][c].rotate),V(a,-h/2,-h/5.4),U(a,h/2,-h/5.4),U(a,h/2,h/5.4),U(a,-h/2,h/5.4),U(a,-h/2,-h/5.4),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function R(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,-h/3),U(a,h/2,-h/3),U(a,0,h/3),U(a,-h/2,-h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function S(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,h/3),U(a,h/2,h/3),U(a,0,-h/3),U(a,-h/2,h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function T(a,b,c,d,f,g){var h,i,j,k,l=g/3.5,m=u[b].length-1;a.strokeStyle=u[b][m-c].strokeStyle,a.translate(e(1.75*l+d),e(1.75*l+f)),a.rotate(u[b][m-c].rotate),a.beginPath(),h=.25*l,i=1.25*l,j=.75*l,k=1.75*l,V(a,-j,-k),U(a,h,-k),U(a,h,h),U(a,i,-j),U(a,i,h),U(a,-h,k),U(a,-k,h),U(a,-k,-j),U(a,-j,h),U(a,-j,-k),a.fillStyle=u[b][m-c].fillColor,a.fill(),a.stroke()}b.drawArrows=T;function U(a,b,c){a.lineTo(e(b)+.5,e(c)+.5)}function V(a,b,c){a.moveTo(e(b)+.5,e(c)+.5)}},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});